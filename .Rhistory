seed = 497294,
temporal_network = F)
modules<-modules_dryad_multilayer$modules
## Calculate distances between islands (locations)-----
distances <- read.csv("/Users/agustin/Desktop/Papers/Canary_Island_Project/spatial_modularity_in_the_canary_islands/R/Extra_analysis/distances_sites_file.csv", sep = ",") %>%
filter(!(layer_from == "WesternSahara1" |layer_to == "WesternSahara1"|
layer_from == "WesternSahara2" |layer_to == "WesternSahara2")) %>%  # remove mainland
rename("mean_distance" = "distance_in_meters")
#add id of locations
distances_with_ids <- distances%>% left_join(layer_metadata, by= c("layer_from"="layer_name")) %>%
left_join(layer_metadata, by= c("layer_to"="layer_name")) %>% #add correct id to layer name
select(mean_distance, layer_id.x, layer_id.y) #discard actual names of layers
names(distances_with_ids)[2] <- "layer_from"
names(distances_with_ids)[3] <- "layer_to"
names(distances_with_ids)[1] <- "mean_distance"
distances_with_ids <- distances_with_ids[c("layer_from", "layer_to", "mean_distance")]
distances_with_ids_inverted<- tibble(layer_from=distances_with_ids$layer_to,
layer_to = distances_with_ids$layer_from,
mean_distance = distances_with_ids$mean_distance)# to add all combination of layers from and to
distances_with_ids_final<-rbind(distances_with_ids,distances_with_ids_inverted) %>% unique()
View(distances_with_ids_final)
## Jaccard on sites (locations) -----
#similarity check 2 furthest apart
modules_for_similarity_num <- modules %>% select(module, layer_id) %>%
unique() %>% group_by(module) %>% select(module) %>% unique()
modules_for_similarity <- modules %>%
filter(module %in% modules_for_similarity_num$module) #only save the modules that are found in 2 or more layers
#pivot modules function for sites as layers
pivot_by_module_islands <- function(data){ #creates a data frame with module on the side and layer_id on the top
s1 = melt(modules_for_similarity, id = c("layer_id", "module"))
s2 = dcast(s1, layer_id ~ module, length)
s3 = t(s2)
s3 <- s3[-1,]
colnames(s3) <- c(1,2,3,4,5,6,7,8,9,10,11,12)
return(s3)
}
module_pivoted <- pivot_by_module_islands(modules_for_similarity)
#edge list per module function for islands as layers
edge_list_per_module_islands <- function(data,edge_list){
#gets one row from a data frame and creates an edge list from it
for (i in (1:11)){
if (data[i]==0) next #only take layers where the module is present
else {
for (j in ((i+1):12)){
if (data[j]==0) next #only take layers where the module is present
else {
edge_list <- rbind(edge_list, tibble(layer_from=i, layer_to=j, module=as.character(NA))) #create edge list of all the layer found in a module
}
}
}
}
return(edge_list)
}
modules_edge_list <- NULL
for (i in (1:nrow(module_pivoted))){ #run the function for each row in the data frame
modules_edge_list <- edge_list_per_module_islands(module_pivoted[i,], modules_edge_list)
current_module <- rownames(module_pivoted)[i]
modules_edge_list <- modules_edge_list %>% mutate(module = replace_na(module, current_module)) #add module number
}
edge_list_with_distances <- left_join(modules_edge_list, distances_with_ids, by= c("layer_from", "layer_to")) #combine the edge list with the distances between each two layers
edge_list_with_distances <- na.omit(edge_list_with_distances) #remove NA and delete layer name
edge_list_with_distances <- left_join(modules_edge_list, distances_with_ids_final, by= c("layer_from", "layer_to")) #combine the edge list with the distances between each two layers
edge_list_with_distances <- na.omit(edge_list_with_distances) #remove NA and delete layer name
View(edge_list_with_distances)
prueba<-  edge_list_with_distances %>% filter(layer_from ==1 & layer_to ==11)
prueba<-  edge_list_with_distances %>% filter(layer_from ==11 & layer_to ==1)
View(distances_with_ids_final)
## Jaccard on sites (locations) -----
#similarity check 2 furthest apart
modules_for_similarity_num <- modules %>% select(module, layer_id) %>%
unique() %>% group_by(module) %>% select(module) %>% unique()
modules_for_similarity <- modules %>%
filter(module %in% modules_for_similarity_num$module) #only save the modules that are found in 2 or more layers
#pivot modules function for sites as layers
pivot_by_module_islands <- function(data){ #creates a data frame with module on the side and layer_id on the top
s1 = melt(modules_for_similarity, id = c("layer_id", "module"))
s2 = dcast(s1, layer_id ~ module, length)
s3 = t(s2)
s3 <- s3[-1,]
colnames(s3) <- c(1,2,3,4,5,6,7,8,9,10,11,12)
return(s3)
}
module_pivoted <- pivot_by_module_islands(modules_for_similarity)
#edge list per module function for islands as layers
edge_list_per_module_islands <- function(data,edge_list){
#gets one row from a data frame and creates an edge list from it
for (i in (1:11)){
if (data[i]==0) next #only take layers where the module is present
else {
for (j in ((i+1):12)){
if (data[j]==0) next #only take layers where the module is present
else {
edge_list <- rbind(edge_list, tibble(layer_from=i, layer_to=j, module=as.character(NA))) #create edge list of all the layer found in a module
}
}
}
}
return(edge_list)
}
modules_edge_list <- NULL
for (i in (1:nrow(module_pivoted))){ #run the function for each row in the data frame
modules_edge_list <- edge_list_per_module_islands(module_pivoted[i,], modules_edge_list)
current_module <- rownames(module_pivoted)[i]
modules_edge_list <- modules_edge_list %>% mutate(module = replace_na(module, current_module)) #add module number
}
edge_list_with_distances <- left_join(modules_edge_list, distances_with_ids_final, by= c("layer_from", "layer_to")) #combine the edge list with the distances between each two layers
edge_list_with_distances <- na.omit(edge_list_with_distances) #remove NA and delete layer name
prueba<-  edge_list_with_distances %>% filter(layer_from ==11 & layer_to ==1)
prueba<-  edge_list_with_distances %>% filter(layer_from ==1 & layer_to ==11)
View(distances_with_ids_final)
View(modules_edge_list)
prena<-modules_edge_list %>% filter(layer_from==1)
prena<-modules_edge_list %>% filter(layer_from==1 & layer_to ==11)
## Jaccard on sites (locations) -----
#similarity check 2 furthest apart
modules_for_similarity_num <- modules %>% select(module, layer_id) %>%
unique() %>% group_by(module) %>% select(module) %>% unique()
modules_for_similarity <- modules %>%
filter(module %in% modules_for_similarity_num$module) #only save the modules that are found in 2 or more layers
#pivot modules function for sites as layers
pivot_by_module_sites <- function(data){ #creates a data frame with module on the side and layer_id on the top
s1 = melt(modules_for_similarity, id = c("layer_id", "module"))
s2 = dcast(s1, layer_id ~ module, length)
s3 = t(s2)
s3 <- s3[-1,]
colnames(s3) <- c(1,2,3,4,5,6,7,8,9,10,11,12)
return(s3)
}
module_pivoted <- pivot_by_module_sites(modules_for_similarity)
#edge list per module function for islands as layers
edge_list_per_module_sites <- function(data,edge_list){
#gets one row from a data frame and creates an edge list from it
for (i in (1:11)){
if (data[i]==0) next #only take layers where the module is present
else {
for (j in ((i+1):12)){
if (data[j]==0) next #only take layers where the module is present
else {
edge_list <- rbind(edge_list, tibble(layer_from=i, layer_to=j, module=as.character(NA))) #create edge list of all the layer found in a module
}
}
}
}
return(edge_list)
}
modules_edge_list <- NULL
for (i in (1:nrow(module_pivoted))){ #run the function for each row in the data frame
modules_edge_list <- edge_list_per_module_sites(module_pivoted[i,], modules_edge_list)
current_module <- rownames(module_pivoted)[i]
modules_edge_list <- modules_edge_list %>% mutate(module = replace_na(module, current_module)) #add module number
}
prena<-modules_edge_list %>% filter(layer_from==1 & layer_to ==11)
#edge list per module function for islands as layers
edge_list_per_module_sites <- function(data,edge_list){
#gets one row from a data frame and creates an edge list from it
for (i in (1:11)){
if (data[i]==0) next #only take layers where the module is present
else {
for (j in ((i+1):12)){
if (data[j]==0) next #only take layers where the module is present
else {
edge_list <- rbind(edge_list, tibble(layer_from=i, layer_to=j, module=as.character(NA))) #create edge list of all the layer found in a module
}
}
}
}
return(edge_list)
}
modules_edge_list <- NULL
for (i in (1:nrow(module_pivoted))){ #run the function for each row in the data frame
modules_edge_list <- edge_list_per_module_sites(module_pivoted[i,], modules_edge_list)
current_module <- rownames(module_pivoted)[i]
modules_edge_list <- modules_edge_list %>% mutate(module = replace_na(module, current_module)) #add module number
}
prena<-modules_edge_list %>% filter(layer_from==1 & layer_to ==11)
prena<-modules_edge_list %>% filter(layer_from==11 & layer_to ==1)
View(modules_for_similarity)
View(module_pivoted)
#edge list per module function for islands as layers
edge_list_per_module_sites <- function(data,edge_list){
#gets one row from a data frame and creates an edge list from it
for (i in (1:11)){
if (data[i]==0) next #only take layers where the module is present
else {
for (j in ((i+1):12)){
if (data[j]==0) next #only take layers where the module is present
else {
edge_list <- rbind(edge_list, tibble(layer_from=i, layer_to=j, module=as.character(NA))) #create edge list of all the layer found in a module
}
}
}
}
return(edge_list)
}
modules_edge_list <- NULL
View(modules)
## Jaccard on sites (locations) -----
#similarity check 2 furthest apart
modules_for_similarity_num <- modules %>% select(module, layer_id) %>%
unique() %>% group_by(module) %>% select(module) %>% unique()
modules_for_similarity_num <- modules %>% select(module, layer_id) %>%
unique() %>% group_by(module) %>% select(module)
View(modules_for_similarity_num)
modules_for_similarity_num <- modules %>% select(module, layer_id) %>%
unique() %>% group_by(module) %>% select(module) %>% unique()
modules_for_similarity <- modules %>%
filter(module %in% modules_for_similarity_num$module) #only save the modules that are found in 2 or more layers
modules_edge_list <- NULL
for (i in (1:nrow(module_pivoted))){ #run the function for each row in the data frame
modules_edge_list <- edge_list_per_module_sites(module_pivoted[i,], modules_edge_list)
current_module <- rownames(module_pivoted)[i]
modules_edge_list <- modules_edge_list %>% mutate(module = replace_na(module, current_module)) #add module number
}
View(modules_edge_list)
#pivot modules function for sites as layers
pivot_by_module_sites <- function(data){ #creates a data frame with module on the side and layer_id on the top
s1 = melt(modules_for_similarity, id = c("layer_id", "module"))
s2 = dcast(s1, layer_id ~ module, length)
s3 = t(s2)
s3 <- s3[-1,]
colnames(s3) <- c(1:12)
return(s3)
}
module_pivoted <- pivot_by_module_sites(modules_for_similarity)
#edge list per module function for islands as layers
edge_list_per_module_sites <- function(data,edge_list){
#gets one row from a data frame and creates an edge list from it
for (i in (1:11)){
if (data[i]==0) next #only take layers where the module is present
else {
for (j in ((i+1):12)){
if (data[j]==0) next #only take layers where the module is present
else {
edge_list <- rbind(edge_list, tibble(layer_from=i, layer_to=j, module=as.character(NA))) #create edge list of all the layer found in a module
}
}
}
}
return(edge_list)
}
modules_edge_list <- NULL
for (i in (1:nrow(module_pivoted))){ #run the function for each row in the data frame
modules_edge_list <- edge_list_per_module_sites(module_pivoted[i,], modules_edge_list)
current_module <- rownames(module_pivoted)[i]
modules_edge_list <- modules_edge_list %>% mutate(module = replace_na(module, current_module)) #add module number
}
edge_list_with_distances <- left_join(modules_edge_list, distances_with_ids_final, by= c("layer_from", "layer_to")) #combine the edge list with the distances between each two layers
View(edge_list_with_distances)
edge_list_with_distances <- na.omit(edge_list_with_distances) #remove NA and delete layer name
prueba<-  edge_list_with_distances %>% filter(layer_from ==1 & layer_to ==11)
prueba<-  edge_list_with_distances %>% filter(layer_from ==11 & layer_to ==1)
## Jaccard on sites (locations) -----
#similarity check 2 furthest apart
modules_for_similarity_num <- modules %>% select(module, layer_id) %>%
unique() %>% group_by(module) %>% select(module) %>% unique()
modules_for_similarity <- modules %>%
filter(module %in% modules_for_similarity_num$module) #only save the modules that are found in 2 or more layers
#pivot modules function for sites as layers
pivot_by_module_sites <- function(data){ #creates a data frame with module on the side and layer_id on the top
s1 = melt(modules_for_similarity, id = c("layer_id", "module"))
s2 = dcast(s1, layer_id ~ module, length)
s3 = t(s2)
s3 <- s3[-1,]
colnames(s3) <- c(1:12)
return(s3)
}
module_pivoted <- pivot_by_module_sites(modules_for_similarity)
View(modules_for_similarity)
emp <- read.csv( "/Users/agustin/Desktop/Papers/Canary_Island_Project/spatial_modularity_in_the_canary_islands/R/Extra_analysis/sites_turnover_with_distnace_empirical.csv", sep =",")
View(emp)
## Distance decay in modules -----
module_sites_turnover <- NULL
for (i in (1:11)){
for (j in ((1+i):12)){
print(i)
modules_in_site_from <- filter(modules_with_lat_lon, layer_id == i) %>% select(module) %>% unique() %>% unlist()
modules_in_site_to <- filter(modules_with_lat_lon, layer_id == j) %>% select(module) %>% unique() %>% unlist()
#take all modules in one layer and all modules in another layer to check turnover
int_both <- intersect(modules_in_site_from, modules_in_site_to) #how many modules are found in both layers
uni_both <- union(modules_in_site_from, modules_in_site_to)
# Calculate turnover
turnover <- ifelse(length(uni_both) == 0, 0, length(int_both) / length(uni_both))
module_sites_turnover <- rbind(module_sites_turnover, tibble(layer_from= i, layer_to= j, turnover= turnover))
}
}
edge_list_with_distances <- left_join(modules_edge_list, distances_with_ids_final, by= c("layer_from", "layer_to")) #combine the edge list with the distances between each two layers
edge_list_with_distances <- na.omit(edge_list_with_distances) #remove NA and delete layer name
#arrange data to include coordinates and modules sizes
size <- count(modules_dryad_multilayer$modules, module)  #create a data frame of all modules and how many nodes are in each (size of module)
module_data <- merge(modules_dryad_multilayer$modules , size, by=c("module","module")) #merge size of module with all the other info about the modules
colnames(module_data)[7] <- "size_of_module" #rename column
lon_lat_data <- read_csv('./csvs_nuevo/layers.csv') %>%
filter(!(layer_name =="WesternSahara1"| layer_name =="WesternSahara2" )) #create new data frame with just the layer data
#cambiar ID segun el nuevo dataframe
lon_lat_data <- lon_lat_data %>% select(c("layer_id","lat","Lon")) %>% na.omit() %>%  #only select layer id and coordinates
select(-layer_id)
lon_lat_data<-tibble(lon_lat_data, layer_id = c(1:12))
module_data_with_loc <- merge(module_data, lon_lat_data, by= c("layer_id","layer_id")) #merge modules with module size with the coordinates
#how many layers are within a module
modules_with_lat_lon <- module_data_with_loc %>% select(layer_id, module, lat, Lon, size_of_module) %>% unique() #take only certain columns
modules_with_lat_lon$count <- c(1)
#version with # of modules in layers
edge_list_by_sites_modules <- edge_list_with_distances
edge_list_by_sites_modules$count <- c(1)
edge_list_by_sites_modules <- edge_list_by_sites_modules %>% group_by(layer_from, layer_to) %>%
mutate(number_of_modules= sum(count)) %>% #count how many modules are shared by 2 islands
select(layer_from, layer_to, module, number_of_modules, mean_distance)
## Distance decay in modules -----
module_sites_turnover <- NULL
for (i in (1:11)){
for (j in ((1+i):12)){
print(i)
modules_in_site_from <- filter(modules_with_lat_lon, layer_id == i) %>% select(module) %>% unique() %>% unlist()
modules_in_site_to <- filter(modules_with_lat_lon, layer_id == j) %>% select(module) %>% unique() %>% unlist()
#take all modules in one layer and all modules in another layer to check turnover
int_both <- intersect(modules_in_site_from, modules_in_site_to) #how many modules are found in both layers
uni_both <- union(modules_in_site_from, modules_in_site_to)
# Calculate turnover
turnover <- ifelse(length(uni_both) == 0, 0, length(int_both) / length(uni_both))
module_sites_turnover <- rbind(module_sites_turnover, tibble(layer_from= i, layer_to= j, turnover= turnover))
}
}
sites_turnover_with_distnace_empirical <- edge_list_by_sites_modules %>%
merge(module_sites_turnover, by= c("layer_from", "layer_to")) %>%
select(layer_from, layer_to, number_of_modules, mean_distance, turnover) %>% unique() #merge both versions
sites_turnover_with_distnace_empirical <- sites_turnover_with_distnace_empirical %>%
mutate(distance_in_km=mean_distance/1000) #turn to km
View(sites_turnover_with_distnace_empirical)
## Distance decay in modules -----
module_sites_turnover <- NULL
for (i in (1:11)){
for (j in ((1+i):12)){
print(i)
modules_in_site_from <- filter(modules_with_lat_lon, layer_id == i) %>% select(module) %>% unique() %>% unlist()
modules_in_site_to <- filter(modules_with_lat_lon, layer_id == j) %>% select(module) %>% unique() %>% unlist()
#take all modules in one layer and all modules in another layer to check turnover
int_both <- intersect(modules_in_site_from, modules_in_site_to) #how many modules are found in both layers
uni_both <- union(modules_in_site_from, modules_in_site_to)
# Calculate turnover
turnover <- ifelse(length(uni_both) == 0, 0, length(int_both) / length(uni_both))
module_sites_turnover <- rbind(module_sites_turnover, tibble(layer_from= i, layer_to= j, turnover= turnover))
}
}
sites_turnover_with_distnace_empirical <- edge_list_by_sites_modules %>%
merge(module_sites_turnover, by= c("layer_from", "layer_to")) %>%
select(layer_from, layer_to, number_of_modules, mean_distance, turnover) %>% unique() #merge both versions
View(modules_with_lat_lon)
View(edge_list_by_sites_modules)
View(edge_list_with_distances)
View(edge_list_with_distances)
emp <- read.csv( "/Users/agustin/Desktop/Papers/Canary_Island_Project/spatial_modularity_in_the_canary_islands/R/Extra_analysis/sites_turnover_with_distnace_empirical.csv", sep =",")
shapiro.test(emp$turnover)#normal
View(emp)
View(distances_with_ids_final)
View(distances_with_ids_final)
#add the layers that don't share any module
to_add<- distances_with_ids_final %>% filter((layer_from ==1 &layer_to ==11) |
layer_from ==1 &layer_to ==12))
#add the layers that don't share any module
to_add<- distances_with_ids_final %>% filter((layer_from ==1 &layer_to ==11) |
(layer_from ==1 &layer_to ==12))
View(to_add)
emp <- read.csv( "/Users/agustin/Desktop/Papers/Canary_Island_Project/spatial_modularity_in_the_canary_islands/R/Extra_analysis/sites_turnover_with_distnace_empirical.csv", sep =",") %>%
select(-number_of_modules,-mean_distance())
emp <- read.csv( "/Users/agustin/Desktop/Papers/Canary_Island_Project/spatial_modularity_in_the_canary_islands/R/Extra_analysis/sites_turnover_with_distnace_empirical.csv", sep =",") %>%
select(-number_of_modules,-mean_distance)
to_add_final<- tibble(to_add,turnover = 0)
View(to_add_final)
View(distances_with_ids_final)
to_add_final<- tibble(to_add,turnover = 0) %>% mutate(distance_in_km = mean_distance /1000)
to_add_final<- tibble(to_add,turnover = 0) %>% mutate(distance_in_km = mean_distance /1000) %>% select(-mean_distance())
to_add_final<- tibble(to_add,turnover = 0) %>% mutate(distance_in_km = mean_distance /1000) %>% select(-mean_distance)
#prepare final dataframe
emp_final<-rbind(emp,to_add_final)
shapiro.test(emp_final$turnover)#normal
m_emp_sites<-MRM(turnover ~ distance_in_km, data=emp_final, nperm=999 )
View(emp_final)
#add the layers that don't share any module
to_add<- distances_with_ids_final %>% filter((layer_from ==1 &layer_to ==11) |
(layer_from ==1 &layer_to ==12)|(layer_from ==2 &layer_to ==11) |
(layer_from ==2 &layer_to ==12))
to_add_final<- tibble(to_add,turnover = 0) %>% mutate(distance_in_km = mean_distance /1000) %>% select(-mean_distance)
#prepare final dataframe
emp_final<-rbind(emp,to_add_final)
shapiro.test(emp_final$turnover)#normal
set.seed(122)
m_emp_sites<-MRM(turnover ~ distance_in_km, data=emp_final, nperm=999 )
m_emp
m_emp_sites
emp_final %>%
ggplot(aes(x= mean_dist_in_km, y= turnover, group= type, color= type))+
geom_point()+
labs(x="Distance (Km)", y="Jaccard Similarity")+
scale_color_manual(values = c("#FB3B1E")) +
theme_classic()+ geom_smooth(method= "lm", se=F)+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
emp_final %>%
ggplot(aes(x= distance_in_km, y= turnover, group= type, color= type))+
geom_point()+
labs(x="Distance (Km)", y="Jaccard Similarity")+
scale_color_manual(values = c("#FB3B1E")) +
theme_classic()+ geom_smooth(method= "lm", se=F)+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
emp_final %>%
ggplot(aes(x= distance_in_km, y= turnover))+
geom_point()+
labs(x="Distance (Km)", y="Jaccard Similarity")+
scale_color_manual(values = c("#FB3B1E")) +
theme_classic()+ geom_smooth(method= "lm", se=F)+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
emp_final %>%
ggplot(aes(x= distance_in_km, y= turnover))+
geom_point(color = "#FB3B1E")+
labs(x="Distance (Km)", y="Jaccard Similarity")+
theme_classic()+ geom_smooth(method= "lm", se=F)+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
emp_final %>%
ggplot(aes(x= distance_in_km, y= turnover))+
geom_point(color = "#FB3B1E")+ geom_line(color = "#FB3B1E")+
labs(x="Distance (Km)", y="Jaccard Similarity")+
theme_classic()+ geom_smooth(method= "lm", se=F)+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
emp_final %>%
ggplot(aes(x= distance_in_km, y= turnover, color = "fixed_color"))+
geom_point(color = "#FB3B1E")+
scale_color_manual(values = c("fixed_color" = "#FB3B1E"))+
labs(x="Distance (Km)", y="Jaccard Similarity")+
theme_classic()+ geom_smooth(method= "lm", se=F)+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
emp_final %>%
ggplot(aes(x= distance_in_km, y= turnover, color = "fixed_color"))+
geom_point(color = "#FB3B1E")+
scale_color_manual(values = c("fixed_color" = "#FB3B1E"))+
labs(x="Distance (Km)", y="Jaccard Similarity")+
theme_classic()+ geom_smooth(method= "lm", se=F)+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))+
guides(color = FALSE)
pdf('./graphs/Modules_DD_sites.pdf', 10, 6)
emp_final %>%
ggplot(aes(x= distance_in_km, y= turnover, color = "fixed_color"))+
geom_point(color = "#FB3B1E")+
scale_color_manual(values = c("fixed_color" = "#FB3B1E"))+
labs(x="Distance (Km)", y="Jaccard Similarity")+
theme_classic()+ geom_smooth(method= "lm", se=F)+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))+
guides(color = FALSE)
dev.off()
m_emp_sites

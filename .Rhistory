axis.line = element_blank())
jaccard_similarity_layer_empirical_and_null_no_self_loop_km <- read.csv("jaccard_similarity_layer_empirical_and_null_no_self_loop_km.csv")
#---- graphs for distance decay in modules empirical and null model 1---
jaccard_similarity_layer_empirical_and_null_no_self_loop_km %>%
ggplot(aes(x= ave_dist, y= ave, group= type, color= type))+
geom_point()+ geom_errorbar(aes(ymin= ave-sd, ymax= ave+sd))+ theme_classic()+ geom_smooth(method= "lm", se=F)+
theme(axis.title=element_text(size=22))+theme(axis.text.x=element_text(size=15))+
theme(axis.text.y=element_text(size=15))+ theme(legend.title = element_text(size = 13), legend.text = element_text(size = 13))+
labs(x="Distance in Km", y="Jaccard Similarity")+
stat_cor(aes(label = after_stat(rr.label)), label.x = 400, label.y = c(0.60, 0.56, 0.52, 0.48))+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=14, color='black'),
axis.title = element_text(size=14, color='black'),
axis.line = element_blank())
correlation_empirical_pols <- read.csv("correlation_empirical_pols.csv")
rqsuares_M1_all <- read.csv("rqsuares_M1_all.csv")
group_color <- c(shuf_pollinators = "#BE75FA",
shuf_plants = "#15B7BC",
shuf_both = "#72A323")
rqsuares_M1_all %>%
ggplot(aes(x = rsquared, fill = type))+
geom_density(alpha = 0.4)+
theme_classic()+ labs(x = "R squared")+
geom_vline(xintercept = correlation_empirical_pols$rsquared, linetype = "dashed", color = "#F47069")+
theme(axis.title=element_text(size=22))+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=14, color='black'),
axis.title = element_text(size=14, color='black'),
axis.line = element_blank())+
scale_fill_manual(values = group_color)
#Shuffled
all_edge_list_sites_combine_no_module_shuf_classic <- read.csv("all_edge_list_sites_combine_no_module_shuf_classic.csv")
ave_module_sites_turnover_shuf_classic <- all_edge_list_sites_combine_no_module_shuf_classic %>%
group_by(layer_from, layer_to) %>%
summarise(ave=mean(turnover), sd=sd(turnover), ave_dist=mean(ave_distance)) %>% mutate(type="null_model_within") #create mean and sd for each point
#add the empirical empirical
sites_turnover_with_distnace_empirical <- read.csv("sites_turnover_with_distnace_empirical.csv")
empirical_turnover_for_module_site_shuf <- sites_turnover_with_distnace_empirical %>% group_by(layer_from, layer_to) %>%
summarise(ave=mean(turnover), sd=sd(turnover), ave_dist=mean(distance_in_km)) %>% mutate(ave_dist= ave_dist*1000,
type="empirical") #make sure sd is 0 cause its the empirical and not null
empirical_turnover_for_module_site_shuf_no_self_loop_classic <- empirical_turnover_for_module_site_shuf %>%
subset(layer_from != layer_to) #distance decay graph for empirical
empirical_turnover_for_module_site_shuf_no_self_loop_km_classic <- empirical_turnover_for_module_site_shuf_no_self_loop_classic %>%
mutate(ave_dist_in_m = ave_dist*1000) #From km to m
##---- combine empirical and shuffle
jaccard_similarity_empirical_and_null_model <- rbind(empirical_turnover_for_module_site_shuf, ave_module_sites_turnover_shuf_classic)
jaccard_similarity_empirical_and_null_no_self_loop_classic <- jaccard_similarity_empirical_and_null_model %>% subset(layer_from != layer_to)
jaccard_similarity_empirical_and_null_no_self_loop_km_classic <- jaccard_similarity_empirical_and_null_no_self_loop_classic %>%
mutate(ave_dist_in_km = ave_dist/1000) #all data set from m to km
just_empirical_within <- jaccard_similarity_empirical_and_null_no_self_loop_km_classic %>% filter(type == "empirical")
jaccard_similarity_empirical_and_null_no_self_loop_km_classic %>% ggplot(aes(x= ave_dist_in_km, y= ave, group= type, color= type))+
geom_point()+ geom_errorbar(aes(ymin= ave-sd, ymax= ave+sd))+ theme_classic()+ geom_smooth(method= "lm", se=F)+
theme(axis.title=element_text(size=22))+theme(axis.text.x=element_text(size=15))+
theme(axis.text.y=element_text(size=15))+ theme(legend.title = element_text(size = 13), legend.text = element_text(size = 13))+
labs(x="Distance in Km", y="Jaccard Similarity")+ stat_cor(aes(label = ..p.label..), label.x = 400)+
stat_cor(aes(label = ..rr.label..), label.x = 400, label.y = c(0.57, 0.54))+ scale_color_manual(values = c("#F47069", "#c4067c"))
correlation_empirical_classic <- read.csv("correlation_empirical_pols.csv")
iteration_correlation_classic <- read.csv("iteration_correlation_classic.csv")
#Distribution of rsquared and add empirical
iteration_correlation_classic %>% ggplot(aes(x = rsquared))+
geom_density(fill = "#c4067c", color = "#c4067c", alpha = 0.4)+
theme_classic()+ labs(x = "R squared")+
geom_vline(xintercept = correlation_empirical_classic$rsquared, linetype = "dashed", color = "#F47069")
jaccard_similarity_empirical_and_null_interactions_no_self_loop_km <- read.csv("jaccard_similarity_empirical_and_null_interactions_no_self_loop_km.csv")
jaccard_similarity_empirical_and_null_interactions_no_self_loop_km %>% ggplot(aes(x= ave_dist_in_km, y= ave, group= type, color= type))+
geom_point()+ geom_errorbar(aes(ymin= ave-sd, ymax= ave+sd))+ theme_classic()+ geom_smooth(method= "lm", se=F)+
theme(axis.title=element_text(size=22))+theme(axis.text.x=element_text(size=15))+
theme(axis.text.y=element_text(size=15))+ theme(legend.title = element_text(size = 13), legend.text = element_text(size = 13))+
labs(x="Distance in Km", y="Jaccard Similarity")+ stat_cor(aes(label = ..p.label..), label.x = 400)+
stat_cor(aes(label = ..rr.label..), label.x = 400, label.y = c(0.63, 0.60, 0.57, 0.54))+
scale_color_manual(values = c("#F47069", "#0033cc"))
correlation_empirical_interactions <- read.csv("correlation_empirical_pols.csv")
iteration_correlation_interactions  <- read.csv("iteration_correlation_interactions.csv")
#Distribution of rsquared and add empirical
iteration_correlation_interactions %>% ggplot(aes(x = rsquared))+
geom_density(fill = "#0033cc", color = "#0033cc", alpha = 0.4)+
theme_classic()+ labs(x = "R squared")+
geom_vline(xintercept = correlation_empirical_interactions$rsquared, linetype = "dashed", color = "#F47069")
iteration_correlation_pols <- read.csv("iteration_correlation_pols.csv")
iteration_correlation_interactions<- read.csv("iteration_correlation_interactions.csv")
correlation_empirical_interactions <- read.csv("correlation_empirical_pols.csv")
interactions_for_beta_diversity <- iteration_correlation_interactions
interactions_for_beta_diversity$type <- "shuffling_interactions"
species_for_beta_diversity <- iteration_correlation_pols
species_for_beta_diversity$type <- "shuffling_species"
correlation_beta_diversity <- rbind(interactions_for_beta_diversity, species_for_beta_diversity)
correlation_beta_diversity %>% ggplot(aes(x = rsquared, color = type, fill = type))+ #overlay shuffling of interactions and species
geom_density(alpha = 0.4)+ scale_color_manual(values = c("#0033cc", "#BE75FA"))+
scale_fill_manual(values = c("#0033cc", "#BE75FA"))+
theme_classic()+ labs(x = "R squared")+
geom_vline(xintercept = correlation_empirical_interactions$rsquared, linetype = "dashed", color = "#F47069")
jaccard_similarity_empirical_and_fixed_no_self_loop_km<- read.csv("jaccard_similarity_empirical_and_fixed_no_self_loop_km.csv")
jaccard_similarity_empirical_and_fixed_no_self_loop_km %>% ggplot(aes(x= ave_dist_in_km, y= ave, group= type, color= type))+
geom_point()+ geom_errorbar(aes(ymin= ave-sd, ymax= ave+sd))+ theme_classic()+ geom_smooth(method= "lm", se=F)+
theme(axis.title=element_text(size=22))+theme(axis.text.x=element_text(size=15))+
theme(axis.text.y=element_text(size=15))+ theme(legend.title = element_text(size = 13), legend.text = element_text(size = 13))+
labs(x="Distance in Km", y="Jaccard Similarity")+ scale_color_manual(values = c("#F47069", "#c4ad06"))+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=14, color='black'),
axis.title = element_text(size=14, color='black'),
axis.line = element_blank())+ stat_cor(aes(label = ..p.label..), label.x = 400)+stat_cor(aes(label = ..rr.label..), label.x = 400, label.y = c(0.65, 0.62))
classic_layers_turnover_with_distances_island <- read.csv("classic_layers_turnover_with_distances_islands_as_layers.csv")
classic_layers_turnover_with_distances <- classic_layers_turnover_with_distances_island %>%
mutate(distance_in_km=mean_distance/1000) #turn to km
classic_layers_turnover_with_distances %>%
ggplot(aes(x=distance_in_km, y=turnover))+ geom_point(color = "indianred2")+ theme_classic()+
stat_smooth(method= "lm", se=F, color = "indianred2")+
theme(axis.title=element_text(size=22))+theme(axis.text.x=element_text(size=15))+
theme(axis.text.y=element_text(size=15))+
labs(x="Distance in Km", y="Jaccard Similarity")+
stat_cor(aes(label = after_stat(rr.label)), label.x = 400, label.y = c(0.36, 0.34, 0.32, 0.30))+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=14, color='black'),
axis.title = element_text(size=14, color='black'),
axis.line = element_blank())
turnover_shuf_and_empirical <- read.csv("turnover_shuf_and_empirical_islands_as_layers.csv")
turnover_shuf_and_empirical %>% ggplot(aes(x= distance_in_km, y= ave, group= type, color= type))+
geom_point()+ geom_errorbar(aes(ymin= ave-sd, ymax= ave+sd))+ theme_classic()+ geom_smooth(method= "lm", se=F)+
labs(x="Distance in Km", y="Jaccard Similarity")+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=14, color='black'),
axis.title = element_text(size=14, color='black'),
axis.line = element_blank()) + stat_cor(aes(label = ..p.label..), label.x = 400)+
stat_cor(aes(label = ..rr.label..), label.x = 400, label.y = c(0.36, 0.34, 0.32, 0.30))
islands_turnover_with_distnace_empirical <- read.csv("islands_turnover_with_distnace_empirical.csv")
islands_turnover_with_distnace_empirical %>%
ggplot(aes(x=distance_in_km, y=turnover))+
geom_point(color = "indianred2")+
scale_x_continuous()+ stat_smooth(method= "lm", se=F, color = "indianred2")+
theme(axis.title=element_text(size=22))+theme(axis.text.x=element_text(size=15))+
theme(axis.text.y=element_text(size=15))+
labs(x="Distance in Km", y="Jaccard Similarity")+ theme_bw()+
stat_cor(aes(label = after_stat(rr.label)), label.x = 400, label.y = c(0.36, 0.34, 0.32, 0.30))+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=14, color='black'),
axis.title = element_text(size=14, color='black'),
axis.line = element_blank())
jaccard_similarity_layer_empirical_and_null_km <- read.csv("jaccard_similarity_layer_empirical_and_null_km_islands.csv")
jaccard_similarity_layer_empirical_and_null_km %>%
ggplot(aes(x= mean_dist_in_km, y= ave, group= type, color= type))+
geom_point()+ geom_errorbar(aes(ymin= ave-sd, ymax= ave+sd))+ theme_classic()+ geom_smooth(method= "lm", se=F)+
theme(axis.title=element_text(size=22))+theme(axis.text.x=element_text(size=15))+
theme(axis.text.y=element_text(size=15))+ theme(legend.title = element_text(size = 13), legend.text = element_text(size = 13))+
labs(x="Distance in Km", y="Jaccard Similarity")+
stat_cor(aes(label = after_stat(rr.label)), label.x = 400, label.y = c(0.60, 0.56, 0.52, 0.48))+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=14, color='black'),
axis.title = element_text(size=14, color='black'),
axis.line = element_blank()) # stat_cor(aes(label = ..p.label..), label.x = 400)+
correlation_empirical_pols <- read.csv("correlation_empirical_pols_islands.csv")
rqsuares_M1_all <- read.csv("rqsuares_M1_all_islands.csv")
group_color <- c(shuf_pollinators = "#BE75FA",
shuf_plants = "#15B7BC",
shuf_both = "#72A323")
rqsuares_M1_all %>%
ggplot(aes(x = rsquared, fill = type))+
geom_density(alpha = 0.4)+
theme_classic()+ labs(x = "R squared")+
geom_vline(xintercept = correlation_empirical_pols$rsquared, linetype = "dashed", color = "#F47069")+
theme(axis.title=element_text(size=22))+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=14, color='black'),
axis.title = element_text(size=14, color='black'),
axis.line = element_blank())+
scale_fill_manual(values = group_color)
jaccard_similarity_layer_empirical_and_null_km  <- read.csv("jaccard_similarity_layer_empirical_and_null_km_islands.csv")
jaccard_similarity_layer_empirical_and_null_km %>%
ggplot(aes(x= mean_dist_in_km, y= ave, group= type, color= type))+
geom_point()+ geom_errorbar(aes(ymin= ave-sd, ymax= ave+sd))+ theme_classic()+ geom_smooth(method= "lm", se=F)+
theme(axis.title=element_text(size=22))+theme(axis.text.x=element_text(size=15))+
theme(axis.text.y=element_text(size=15))+ theme(legend.title = element_text(size = 13), legend.text = element_text(size = 13))+
labs(x="Distance in Km", y="Jaccard Similarity")+
stat_cor(aes(label = after_stat(rr.label)), label.x = 400, label.y = c(0.60, 0.56, 0.52, 0.48))+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=14, color='black'),
axis.title = element_text(size=14, color='black'),
axis.line = element_blank()) + stat_cor(aes(label = ..p.label..), label.x = 400)
#distribution of rsquared and add empirical
correlation_empirical_interactions <- read.csv("correlation_empirical_interactions_islands.csv")
iteration_correlation_interactions <- read.csv("iteration_correlation_interactions_islands.csv")
iteration_correlation_interactions %>% ggplot(aes(x = rsquared))+
geom_density(fill = "#0033cc", color = "#0033cc", alpha = 0.4)+
theme_classic()+ labs(x = "R squared")+
geom_vline(xintercept = correlation_empirical_interactions$rsquared, linetype = "dashed", color = "#F47069")
##compare both parts of beta diversity (shuffling pollinator species )
iteration_correlation_pols <- read.csv("iteration_correlation_pols_islands.csv")
iteration_correlation_interactions <- read.csv("iteration_correlation_interactions_islands.csv")
correlation_empirical_interactions <- read.csv("correlation_empirical_interactions_islands.csv")
interactions_for_beta_diversity <- iteration_correlation_interactions
interactions_for_beta_diversity$type <- "shuffling_interactions"
species_for_beta_diversity <- iteration_correlation_pols
species_for_beta_diversity$type <- "shuffling_species"
correlation_beta_diversity <- rbind(interactions_for_beta_diversity, species_for_beta_diversity)
correlation_beta_diversity %>% ggplot(aes(x = rsquared, color = type, fill = type))+ #overlay shuffling of interactions and species
geom_density(alpha = 0.4)+ scale_color_manual(values = c("#0033cc", "#BE75FA"))+
scale_fill_manual(values = c("#0033cc", "#BE75FA"))+
theme_classic()+ labs(x = "R squared")+
geom_vline(xintercept = correlation_empirical_interactions$rsquared, linetype = "dashed", color = "#F47069")
jaccard_similarity_empirical_and_fixed_no_self_loop_km<- read.csv("jaccard_similarity_empirical_and_fixed_no_self_loop_km_islands.csv")
jaccard_similarity_empirical_and_fixed_no_self_loop_km %>% ggplot(aes(x= ave_dist_in_km, y= ave, group= type, color= type))+
geom_point()+ geom_errorbar(aes(ymin= ave-sd, ymax= ave+sd))+ theme_classic()+ geom_smooth(method= "lm", se=F)+
theme(axis.title=element_text(size=22))+theme(axis.text.x=element_text(size=15))+
theme(axis.text.y=element_text(size=15))+ theme(legend.title = element_text(size = 13), legend.text = element_text(size = 13))+
labs(x="Distance in Km", y="Jaccard Similarity")+ scale_color_manual(values = c("#F47069", "#c4ad06"))+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=14, color='black'),
axis.title = element_text(size=14, color='black'),
axis.line = element_blank()) + stat_cor(aes(label = ..p.label..), label.x = 400)+
stat_cor(aes(label = ..rr.label..), label.x = 400, label.y = c(0.65, 0.62))
##---load_libraries-------------------------------------------------------------------------------------------------
options(rgl.useNULL = TRUE)
library(infomapecology)
library(igraph)
library(bipartite)
library(tidyverse)
library(magrittr)
library(betalink)
library(readxl)
library(ggalluvial)
library(scatterpie)
library(reshape2)
library(ggforce)
library(ggmap)
library(ggraph)
library(ggpubr)
library(reshape2)
library(extRC)
library(ecodist)
##----get_data--------------------------------------------------------------------------------------------------------
setwd("/Users/agustin/Desktop/Papers/Canary_Island_Project/spatial_modularity_in_the_canary_islands")
source("/Users/agustin/Desktop/Papers/Canary_Island_Project/spatial_modularity_in_the_canary_islands/R/functions.R")
## Statistical analysis -----
emp <- read.csv("./csvs_nuevo/justislands_turnover_with_distnace_empirical.csv", sep =",")
shapiro.test(emp$turnover)#normal
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=9999 )
m_emp
anova(m_emp)
View(m_emp)
summary(m_emp)
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=9999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=9999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=9999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=9999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=9999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=9999 )
m_emp
emp$scaled_distance_in_km<- scale(emp$distance_in_km) #scale the distance
m_emp2<-MRM(turnover ~ scaled_distance_in_km,data=emp,nperm=9999 )#scaled
m_emp2
m_emp2<-MRM(turnover ~ scaled_distance_in_km,data=emp,nperm=9999 )#scaled
m_emp2
m_emp2<-MRM(turnover ~ scaled_distance_in_km,data=emp,nperm=9999 )#scaled
m_emp2
m_emp2
m_emp2<-MRM(turnover ~ scaled_distance_in_km,data=emp,nperm=9999 )#scaled
m_emp2
m_emp2<-MRM(turnover ~ scaled_distance_in_km,data=emp,nperm=9999 )#scaled
m_emp2
m_emp2<-MRM(turnover ~ scaled_distance_in_km,data=emp,nperm=9999 )#scaled
m_emp2
m_emp2<-MRM(turnover ~ scaled_distance_in_km,data=emp,nperm=9999 )#scaled
m_emp2
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=9999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=9999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=99 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=99 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=99 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
summary(m_emp)
# To extract specific values:
slope <- m_emp$coefficients[1]  # This gets the slope coefficient; index might need adjustment
p_value <- m_emp$p.value
View(emp)
#------check if its significant for islands----------------------------------------------------------------
jaccard_similarity_layer_empirical_and_null_km <- read.csv("./csvs_nuevo/jaccard_similarity_layer_empirical_and_null_km_justislands_m1.csv")
## check normality
pol<-jaccard_similarity_layer_empirical_and_null_km %>% filter(type=="null_pollinators")
pla<-jaccard_similarity_layer_empirical_and_null_km %>% filter(type=="null_plants")
both<-jaccard_similarity_layer_empirical_and_null_km %>% filter(type=="null_both")
shapiro.test(pol$ave)
shapiro.test(pla$ave)
shapiro.test(both$ave)
View(pol)
View(pol)
##models
m_pol<-MRM(ave ~ mean_dist_in_km,data=pol,nperm=9999 )
m_pol
m_pla<-MRM(ave ~ mean_dist_in_km,data=pla,nperm=9999 )
m_pla
m_emp<-MRM(turnover ~ distance_in_km,data=emp)
summary(m_emp)
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp)
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
View(m_emp)
View(emp)
## Statistical analysis -----
set.seed(999)
emp <- read.csv("./csvs_nuevo/justislands_turnover_with_distnace_empirical.csv", sep =",")
shapiro.test(emp$turnover)#normal
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
set.seed(999)
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
set.seed(999)
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
set.seed(999)
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
set.seed(999)
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
set.seed(998)
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
set.seed(998)
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
set.seed(98)
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
set.seed(123)
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
set.seed(124)
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
set.seed(122)
m_emp<-MRM(turnover ~ distance_in_km,data=emp,nperm=999 )
m_emp
#write.csv(iteration_correlation_both, "./csvs_nuevo/iteration_correlation_both.csv", row.names = FALSE)
iteration_correlation_both<- read.csv("./csvs_nuevo/iteration_correlation_both.csv")
#test
greater <- sum(iteration_correlation_both$slope >  -0.00087)
less <- sum(iteration_correlation_both$slope  <  -0.00087)
p_slope_both<- 2 * min(greater, less) / 1000 #calculate manually t-test two tailed
#write.csv(iteration_correlation_plants, "./csvs_nuevo/iteration_correlation_plants.csv", row.names = FALSE)
iteration_correlation_plants <- read.csv("./csvs_nuevo/iteration_correlation_plants.csv")
greater <- sum(iteration_correlation_plants$slope >  -0.00087)
less <- sum(iteration_correlation_plants$slope  <  -0.00087)
p_slope_plant<- 2 * min(greater, less) / 1000 #calculate manually t-test two tailed
##models
m_pol<-MRM(ave ~ mean_dist_in_km,data=pol, nperm =9999 )
m_pol
m_both<-MRM(ave ~ mean_dist_in_km,data=both,nperm=9999 )
m_both
#write.csv(iteration_correlation_plants, "./csvs_nuevo/iteration_correlation_plants.csv", row.names = FALSE)
iteration_correlation_plants <- read.csv("./csvs_nuevo/iteration_correlation_plants.csv")
#write.csv(iteration_correlation_pols, "./csvs_nuevo/iteration_correlation_pols.csv", row.names = FALSE)
iteration_correlation_pols <- read.csv("./csvs_nuevo/iteration_correlation_pols.csv")
greater <- sum(iteration_correlation_pols$slope >  -0.00087)
less <- sum(iteration_correlation_pols$slope  <  -0.00087)
p_slope_pols<- 2 * min(greater, less) / 1000 #calculate manually t-test two tailed
#write.csv(iteration_correlation_both, "./csvs_nuevo/iteration_correlation_both.csv", row.names = FALSE)
iteration_correlation_both<- read.csv("./csvs_nuevo/iteration_correlation_both.csv")
#test
greater <- sum(iteration_correlation_both$slope >  -0.00087)
less <- sum(iteration_correlation_both$slope  <  -0.00087)
p_slope_both<- 2 * min(greater, less) / 1000 #calculate manually t-test two tailed
both<-jaccard_similarity_layer_empirical_and_null_km %>% filter(type=="null_both")
m_both<-MRM(ave ~ mean_dist_in_km,data=both,nperm=9999 )
m_both
#---- statistical analysis--------------------------------------------------
jaccard_similarity_layer_empirical_and_null_km_interactions <- read.csv("./csvs_nuevo/jaccard_similarity_layer_empirical_and_null_km_interactions_justislands.csv") #need to read this to run next part
null<-jaccard_similarity_layer_empirical_and_null_km_interactions %>% filter(type=="null_model_int")
shapiro.test(null$ave)
## modeL
m_int<-MRM(ave ~ mean_dist_in_km,data=null, nperm =9999 )
m_int
iteration_correlation_interactions<- read.csv("./csvs_nuevo/iteration_correlation_interactions_justislands.csv")
#test
greater <- sum(iteration_correlation_interactions$slope >  -0.00087)
less <- sum(iteration_correlation_interactions$slope  <  -0.00087)
p_slope_int<- 2 * min(greater, less) / 1000 #calculate manually t-test two tailed
#---- statistical analysis--------------------------------------------------
jaccard_similarity_layer_empirical_and_null_km_classic<- read.csv("./csvs_nuevo/jaccard_similarity_layer_empirical_and_null_km_classic_justislands.csv") #need to read this to run next part
null<-jaccard_similarity_layer_empirical_and_null_km_classic %>% filter(type=="null_model_within")
shapiro.test(null$ave)#normal
## modeL
m_classic<-MRM(ave ~ mean_dist_in_km,data=null, nperm =9999 )
m_classic
iteration_correlation_classic<- read.csv("./csvs_nuevo/iteration_correlation_classic_justislands.csv")
#test
greater <- sum(iteration_correlation_classic$slope >  -0.00087)
less <- sum(iteration_correlation_classic$slope  <  -0.00087)
p_slope_local<- 2 * min(greater, less) / 1000 #calculate manually t-test two tailed

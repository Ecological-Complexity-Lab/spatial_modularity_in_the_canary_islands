geom_vline(xintercept = -0.00087, linetype = "dashed", color = "#FB3B1E")+ #line R squared empirical
labs(x= "Slope", y="Density")+
scale_fill_manual(name = "Models",  labels = c(expression("NM"[1]^P),expression("NM"[1]^A),
expression("NM"[1]^AP)), values = c("#72A323","#A44CD3", "#15B7BC"))+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
dev.off()
##---load_libraries-------------------------------------------------------------------------------------------------
options(rgl.useNULL = TRUE)
library(infomapecology)
library(igraph)
library(bipartite)
library(tidyverse)
library(magrittr)
library(betalink)
library(readxl)
library(ggalluvial)
library(scatterpie)
library(reshape2)
library(ggforce)
library(ggmap)
library(ggraph)
library(ggtree)
library(ggpubr)
library(ecodist)
##----get_data--------------------------------------------------------------------------------------------------------
setwd("/Users/agustin/Desktop/Papers/Canary_Island_Project/spatial_modularity_in_the_canary_islands")
source("/Users/agustin/Desktop/Papers/Canary_Island_Project/spatial_modularity_in_the_canary_islands/R/functions.R")
#---- statistical analysis--------------------------------------------------
jaccard_similarity_layer_empirical_and_null_km_interactions <- read.csv("./csvs_nuevo/jaccard_similarity_layer_empirical_and_null_km_interactions_justislands.csv") #need to read this to run next part
null<-jaccard_similarity_layer_empirical_and_null_km_interactions %>% filter(type=="null_model_int")
shapiro.test(null$ave)
#---- multiple regression on distances matrices and correlation
all_edge_list_islands_combine_no_module_shuf_interactions_output <- read.csv("./csvs_nuevo/all_edge_list_justislands_combine_no_module_shuf_interactions.csv")
iteration_correlation_interactions <- NULL
iteration_correlation_data_interactions <- all_edge_list_islands_combine_no_module_shuf_interactions_output %>% subset(layer_from != layer_to)
iteration_correlation_data_interactions_km <- iteration_correlation_data_interactions %>%
mutate(mean_dist_in_km = mean_distance/1000)%>% group_by(trial) %>%
distinct(layer_from,layer_to, .keep_all = T)
for (i in 1:1000){
trial_interactions = iteration_correlation_data_interactions_km %>% filter(trial == i)
iteration_correlation_new_interactions <- cor.test(trial_interactions$turnover, trial_interactions$mean_dist_in_km, method = "pearson")
mrm_val_interactions <- MRM(turnover ~ mean_dist_in_km, data = trial_interactions)
iteration_correlation_interactions <- rbind(iteration_correlation_interactions, tibble(estimate = iteration_correlation_new_interactions$estimate,
p_val = iteration_correlation_new_interactions$p.value,
statistic = iteration_correlation_new_interactions$statistic,
confidence_int_low = iteration_correlation_new_interactions$conf.int[1],
confidence_int_high = iteration_correlation_new_interactions$conf.int[2],
slope = mrm_val_interactions$coef[2],
intercept = mrm_val_interactions$coef[1],
rsquared = mrm_val_interactions$r.squared[1],
trial_num = i))
}
write.csv(iteration_correlation_interactions, "./csvs_nuevo/iteration_correlation_interactions_justislands.csv", row.names = FALSE)
#test
greater <- sum(iteration_correlation_interactions$slope >  -0.00087)
less <- sum(iteration_correlation_interactions$slope  <  -0.00087)
p_slope_int<- 2 * min(greater, less) / 1000 #calculate manually t-test two tailed
iteration_correlation_interactions2 %>% ggplot(aes(x = slope, fill= Type))+
geom_density(alpha = 0.6)+
geom_vline(xintercept = -0.00087, linetype = "dashed", color = "#FB3B1E") + #line represting rsquared empirical
labs(x= "Slope", y="Density")+
scale_fill_manual(name = "Models",  label = expression("NM"[2]), values= "#E6AB02")+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
iteration_correlation_interactions2<-iteration_correlation_interactions %>% mutate(Type = "null_int")
iteration_correlation_interactions2 %>% ggplot(aes(x = slope, fill= Type))+
geom_density(alpha = 0.6)+
geom_vline(xintercept = -0.00087, linetype = "dashed", color = "#FB3B1E") + #line represting rsquared empirical
labs(x= "Slope", y="Density")+
scale_fill_manual(name = "Models",  label = expression("NM"[2]), values= "#E6AB02")+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
pdf('./graphs/NM2_slope_module_DD.pdf', 10, 6)
iteration_correlation_interactions2 %>% ggplot(aes(x = slope, fill= Type))+
geom_density(alpha = 0.6)+
geom_vline(xintercept = -0.00087, linetype = "dashed", color = "#FB3B1E") + #line represting rsquared empirical
labs(x= "Slope", y="Density")+
scale_fill_manual(name = "Models",  label = expression("NM"[2]), values= "#E6AB02")+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
dev.off()
##---load_libraries-------------------------------------------------------------------------------------------------
options(rgl.useNULL = TRUE)
library(infomapecology)
library(igraph)
library(bipartite)
library(tidyverse)
library(magrittr)
library(betalink)
library(readxl)
library(ggalluvial)
library(scatterpie)
library(reshape2)
library(ggforce)
library(ggmap)
library(ggraph)
library(ggtree)
library(ggpubr)
library(ecodist)
##----get_data--------------------------------------------------------------------------------------------------------
setwd("/Users/agustin/Desktop/Papers/Canary_Island_Project/spatial_modularity_in_the_canary_islands")
source("/Users/agustin/Desktop/Papers/Canary_Island_Project/spatial_modularity_in_the_canary_islands/R/functions.R")
#---- create ave for jaccard layers-------------------------------------------------------------------------
all_edge_list_islands_combine_no_module_shuf_classic_output <- read.csv("./csvs_nuevo/all_edge_list_justislands_combine_no_module_shuf_classic.csv")
ave_module_islands_turnover_shuf_classic <- all_edge_list_islands_combine_no_module_shuf_classic_output %>%
group_by(layer_from, layer_to) %>%
summarise(ave=mean(turnover), sd=sd(turnover), ave_dist=mean(mean_distance)) %>% mutate(type="null_model_within") #create mean and sd for each point
#add empirical
islands_turnover_with_distnace_empirical <- read.csv("./csvs_nuevo/justislands_turnover_with_distnace_empirical.csv")
empirical_turnover_for_modules_layers_shuf <- islands_turnover_with_distnace_empirical %>% group_by(layer_from, layer_to) %>%
summarise(ave = mean(turnover), sd = sd(turnover), ave_dist = mean_distance) %>% mutate(type="empirical") #make sure sd is 0 cause its the empirical and not null
#---- combine for jaccard analysis------------------------------------------------------------------------------------------------------
#combine all layers
jaccard_similarity_empirical_and_null_classic <- rbind(empirical_turnover_for_modules_layers_shuf,
ave_module_islands_turnover_shuf_classic)
jaccard_similarity_layer_empirical_and_null_km_classic <- jaccard_similarity_empirical_and_null_classic %>%
mutate(mean_dist_in_km = ave_dist/1000)
#---- statistical analysis--------------------------------------------------
jaccard_similarity_layer_empirical_and_null_km_classic<- read.csv("./csvs_nuevo/jaccard_similarity_layer_empirical_and_null_km_classic_justislands.csv") #need to read this to run next part
null<-jaccard_similarity_layer_empirical_and_null_km_classic %>% filter(type=="null_model_within")
shapiro.test(null$ave)#normal
#----correlation and r sqaured between jaccard and distance for each run
all_edge_list_islands_combine_no_module_shuf_classic <- read.csv("./csvs_nuevo/all_edge_list_justislands_combine_no_module_shuf_classic.csv")
iteration_correlation_classic <- NULL
iteration_correlation_data_classic <- all_edge_list_islands_combine_no_module_shuf_classic %>% subset(layer_from != layer_to)
iteration_correlation_data_classic_km <- iteration_correlation_data_classic %>%
mutate(mean_dist_in_km = mean_distance/1000)%>% group_by(trial) %>%
distinct(layer_from,layer_to, .keep_all = T)
for (i in 1:1000){
trial_classic = iteration_correlation_data_classic_km %>% filter(trial == i)
iteration_correlation_new_classic <- cor.test(trial_classic$turnover, trial_classic$mean_dist_in_km, method = "pearson")
mrm_val_classic <- MRM(turnover ~ mean_dist_in_km, data = trial_classic)
iteration_correlation_classic <- rbind(iteration_correlation_classic, tibble(estimate = iteration_correlation_new_classic$estimate,
p_val = iteration_correlation_new_classic$p.value,
statistic = iteration_correlation_new_classic$statistic,
confidence_int_low = iteration_correlation_new_classic$conf.int[1],
confidence_int_high = iteration_correlation_new_classic$conf.int[2],
slope = mrm_val_classic$coef[2],
intercept = mrm_val_classic$coef[1],
rsquared = mrm_val_classic$r.squared[1],
trial_num = i))
}
write.csv(iteration_correlation_classic, "./csvs_nuevo/iteration_correlation_classic_justislands.csv", row.names = FALSE)
#test
greater <- sum(iteration_correlation_classic$slope >  -0.00087)
less <- sum(iteration_correlation_classic$slope  <  -0.00087)
p_slope_local<- 2 * min(greater, less) / 1000 #calculate manually t-test two tailed
iteration_correlation_classic2<-iteration_correlation_classic %>% mutate(Type = "null_class")
iteration_correlation_classic2 %>% ggplot(aes(x = slope, fill= Type))+
geom_density(alpha = 0.6)+
geom_vline(xintercept = -0.111, linetype = "dashed", color = "#FB3B1E") +
labs(x= "Slope", y="Density")+
scale_fill_manual(name = "Models",  label = expression("NM"[3]), values= "#FA86F2")+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
iteration_correlation_classic2 %>% ggplot(aes(x = slope, fill= Type))+
geom_density(alpha = 0.6)+
geom_vline(xintercept = -0.00087, linetype = "dashed", color = "#FB3B1E") +
labs(x= "Slope", y="Density")+
scale_fill_manual(name = "Models",  label = expression("NM"[3]), values= "#FA86F2")+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
pdf('./graphs/NM3_slope_module_DD.pdf', 10, 6)
iteration_correlation_classic2 %>% ggplot(aes(x = slope, fill= Type))+
geom_density(alpha = 0.6)+
geom_vline(xintercept = -0.00087, linetype = "dashed", color = "#FB3B1E") +
labs(x= "Slope", y="Density")+
scale_fill_manual(name = "Models",  label = expression("NM"[3]), values= "#FA86F2")+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
dev.off()
knitr::opts_chunk$set(echo = FALSE, results = "asis", message=FALSE, warning=FALSE, cache=TRUE, eval = TRUE, dev = c('png'), out.width = '100%', out.height='40%')
# Panel A
rqsuares_M1_all <- read.csv("./csvs_nuevo/slopes_NM1_all_nonscaled.csv")
# Panel A
NM1 <- read.csv("slopes_NM1_all_nonscaled.csv")
#Panel B
iteration_correlation_interactions <- read.csv("iteration_correlation_interactions_islands.csv")
#Panel B
iteration_correlation_interactions <- read.csv("iteration_correlation_interactions_justislands.csv")
iteration_correlation_interactions2<-iteration_correlation_interactions %>% mutate(Type = "null_int")
Panel_B<- iteration_correlation_interactions2 %>% ggplot(aes(x = slope, fill= Type))+
geom_density(alpha = 0.6)+
geom_vline(xintercept = -0.00087, linetype = "dashed", color = "#FB3B1E") + #line represting rsquared empirical
labs(x= "Slope", y="Density")+
scale_fill_manual(name = "Models",  label = expression("NM"[2]), values= "#E6AB02")+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
#Panel C
iteration_correlation_classic <- read.csv("iteration_correlation_classic_islands.csv")
#Panel C
iteration_correlation_classic <- read.csv("iteration_correlation_classic_justislands.csv")
iteration_correlation_classic2<-iteration_correlation_classic %>% mutate(Type = "null_class")
Panel_C<- iteration_correlation_classic2 %>% ggplot(aes(x = slope, fill= Type))+
geom_density(alpha = 0.6)+
geom_vline(xintercept = -0.00087, linetype = "dashed", color = "#FB3B1E") +
labs(x= "Slope", y="Density")+
scale_fill_manual(name = "Models",  label = expression("NM"[3]), values= "#FA86F2")+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
Panel_C
upper_row<- plot_grid(Panel_A + theme(plot.margin = unit(c(0.2,0.25,0.2,0.5), "cm")),
Panel_B + theme(plot.margin = unit(c(0.2,0.25,0.2,0.5), "cm")),
ncol = 2, labels = c('(A)', "(B)"))
# Panel A
NM1 <- read.csv("slopes_NM1_all_nonscaled.csv")
NM1$type <- factor(NM1$type, levels = c("shuf_plants","shuf_pollinators","shuf_both"))
Panel_A <- NM1 %>%
ggplot(aes(x = slope, fill = type))+
geom_density(alpha = 0.5)+
geom_vline(xintercept = -0.00087, linetype = "dashed", color = "#FB3B1E")+ #line R squared empirical
labs(x= "Slope", y="Density")+
scale_fill_manual(name = "Models",  labels = c(expression("NM"[1]^P),expression("NM"[1]^A),
expression("NM"[1]^AP)), values = c("#72A323","#A44CD3", "#15B7BC"))+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
Panel_A
#Panel B
iteration_correlation_interactions <- read.csv("iteration_correlation_interactions_justislands.csv")
iteration_correlation_interactions2<-iteration_correlation_interactions %>% mutate(Type = "null_int")
Panel_B<- iteration_correlation_interactions2 %>% ggplot(aes(x = slope, fill= Type))+
geom_density(alpha = 0.6)+
geom_vline(xintercept = -0.00087, linetype = "dashed", color = "#FB3B1E") + #line represting rsquared empirical
labs(x= "Slope", y="Density")+
scale_fill_manual(name = "Models",  label = expression("NM"[2]), values= "#E6AB02")+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
#Panel C
iteration_correlation_classic <- read.csv("iteration_correlation_classic_justislands.csv")
iteration_correlation_classic2<-iteration_correlation_classic %>% mutate(Type = "null_class")
Panel_C<- iteration_correlation_classic2 %>% ggplot(aes(x = slope, fill= Type))+
geom_density(alpha = 0.6)+
geom_vline(xintercept = -0.00087, linetype = "dashed", color = "#FB3B1E") +
labs(x= "Slope", y="Density")+
scale_fill_manual(name = "Models",  label = expression("NM"[3]), values= "#FA86F2")+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
upper_row<- plot_grid(Panel_A + theme(plot.margin = unit(c(0.2,0.25,0.2,0.5), "cm")),
Panel_B + theme(plot.margin = unit(c(0.2,0.25,0.2,0.5), "cm")),
ncol = 2, labels = c('(A)', "(B)"))
bottom_row<- plot_grid(NULL,Panel_C + theme(plot.margin = unit(c(0.2,0.25,0.2,0.5), "cm")),
ncol = 2, labels = c("(C)","x"))
plot_grid(upper_row, bottom_row, ncol = 1, rel_heights = c(1, 1))
##---load_libraries-------------------------------------------------------------------------------------------------
options(rgl.useNULL = TRUE)
library(infomapecology)
library(igraph)
library(bipartite)
library(tidyverse)
library(magrittr)
library(betalink)
library(readxl)
library(ggalluvial)
library(scatterpie)
library(reshape2)
library(ggforce)
library(ggmap)
library(ggraph)
library(ggpubr)
library(reshape2)
library(extRC)
##----get_data--------------------------------------------------------------------------------------------------------
setwd("/Users/agustin/Desktop/Papers/Canary_Island_Project/spatial_modularity_in_the_canary_islands")
source("/Users/agustin/Desktop/Papers/Canary_Island_Project/spatial_modularity_in_the_canary_islands/R/functions.R")
# Panel A
# Panel A
NM1 <- read.csv("slopes_NM1_all_nonscaled.csv")
NM1$type <- factor(NM1$type, levels = c("shuf_plants","shuf_pollinators","shuf_both"))
#Panel B
iteration_correlation_interactions <- read.csv("./csvs_nuevo/iteration_correlation_interactions_justislands.csv")
iteration_correlation_interactions2<-iteration_correlation_interactions %>% mutate(Type = "null_int")
# Panel A
# Panel A
NM1 <- read.csv("./csvs_nuevo/slopes_NM1_all_nonscaled.csv")
NM1$type <- factor(NM1$type, levels = c("shuf_plants","shuf_pollinators","shuf_both"))
Panel_A <- NM1 %>%
ggplot(aes(x = slope, fill = type))+
geom_density(alpha = 0.5)+
geom_vline(xintercept = -0.00087, linetype = "dashed", color = "#FB3B1E")+ #line R squared empirical
labs(x= "Slope", y="Density")+
scale_fill_manual(name = "Models",  labels = c(expression("NM"[1]^P),expression("NM"[1]^A),
expression("NM"[1]^AP)), values = c("#72A323","#A44CD3", "#15B7BC"))+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
Panel_A
#Panel B
iteration_correlation_interactions <- read.csv("./csvs_nuevo/iteration_correlation_interactions_justislands.csv")
iteration_correlation_interactions2<-iteration_correlation_interactions %>% mutate(Type = "null_int")
Panel_B<- iteration_correlation_interactions2 %>% ggplot(aes(x = slope, fill= Type))+
geom_density(alpha = 0.6)+
geom_vline(xintercept = -0.00087, linetype = "dashed", color = "#FB3B1E") + #line represting rsquared empirical
labs(x= "Slope", y="Density")+
scale_fill_manual(name = "Models",  label = expression("NM"[2]), values= "#E6AB02")+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
Panel_B
#Panel C
iteration_correlation_classic <- read.csv("./csvs_nuevo/iteration_correlation_classic_justislands.csv")
iteration_correlation_classic2<-iteration_correlation_classic %>% mutate(Type = "null_class")
Panel_C<- iteration_correlation_classic2 %>% ggplot(aes(x = slope, fill= Type))+
geom_density(alpha = 0.6)+
geom_vline(xintercept = -0.00087, linetype = "dashed", color = "#FB3B1E") +
labs(x= "Slope", y="Density")+
scale_fill_manual(name = "Models",  label = expression("NM"[3]), values= "#FA86F2")+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
Panel_C
upper_row<- plot_grid(Panel_A + theme(plot.margin = unit(c(0.2,0.25,0.2,0.5), "cm")),
Panel_B + theme(plot.margin = unit(c(0.2,0.25,0.2,0.5), "cm")),
ncol = 2, labels = c('(A)', "(B)"))
bottom_row<- plot_grid(NULL,Panel_C + theme(plot.margin = unit(c(0.2,0.25,0.2,0.5), "cm")),
ncol = 2, labels = c("(C)","x"))
plot_grid(upper_row, bottom_row, ncol = 1, rel_heights = c(1, 1))
# Figure 4 (all panels together)
pdf('./graphs/Figure_4.pdf', 10, 8)
upper_row<- plot_grid(Panel_A + theme(plot.margin = unit(c(0.2,0.25,0.2,0.5), "cm")),
Panel_B + theme(plot.margin = unit(c(0.2,0.25,0.2,0.5), "cm")),
ncol = 2, labels = c('(A)', "(B)"))
bottom_row<- plot_grid(NULL,Panel_C + theme(plot.margin = unit(c(0.2,0.25,0.2,0.5), "cm")),
ncol = 2, labels = c("(C)","x"))
plot_grid(upper_row, bottom_row, ncol = 1, rel_heights = c(1, 1))
dev.off()
# Panel A
# Panel A
NM1 <- read.csv("./csvs_nuevo/slopes_NM1_all_nonscaled.csv")
NM1$type <- factor(NM1$type, levels = c("shuf_plants","shuf_pollinators","shuf_both"))
Panel_A <- NM1 %>%
ggplot(aes(x = slope, fill = type))+
geom_density(alpha = 0.5)+
geom_vline(xintercept = -0.00087, linetype = "dashed", color = "#FB3B1E")+ #line R squared empirical
labs(x= "Slope", y="Density")+
scale_fill_manual(name = "Models",  labels = c(expression("NM"[1]^P),expression("NM"[1]^A),
expression("NM"[1]^AP)), values = c("#72A323","#A44CD3", "#15B7BC"))+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=13, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
Panel_A
#Panel B
iteration_correlation_interactions <- read.csv("./csvs_nuevo/iteration_correlation_interactions_justislands.csv")
iteration_correlation_interactions2<-iteration_correlation_interactions %>% mutate(Type = "null_int")
Panel_B<- iteration_correlation_interactions2 %>% ggplot(aes(x = slope, fill= Type))+
geom_density(alpha = 0.6)+
geom_vline(xintercept = -0.00087, linetype = "dashed", color = "#FB3B1E") + #line represting rsquared empirical
labs(x= "Slope", y="Density")+
scale_fill_manual(name = "Models",  label = expression("NM"[2]), values= "#E6AB02")+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=13, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
Panel_B
#Panel C
iteration_correlation_classic <- read.csv("./csvs_nuevo/iteration_correlation_classic_justislands.csv")
iteration_correlation_classic2<-iteration_correlation_classic %>% mutate(Type = "null_class")
Panel_C<- iteration_correlation_classic2 %>% ggplot(aes(x = slope, fill= Type))+
geom_density(alpha = 0.6)+
geom_vline(xintercept = -0.00087, linetype = "dashed", color = "#FB3B1E") +
labs(x= "Slope", y="Density")+
scale_fill_manual(name = "Models",  label = expression("NM"[3]), values= "#FA86F2")+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=13, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
Panel_C
# Figure 4 (all panels together)
pdf('./graphs/Figure_4.pdf', 10, 8)
upper_row<- plot_grid(Panel_A + theme(plot.margin = unit(c(0.2,0.25,0.2,0.5), "cm")),
Panel_B + theme(plot.margin = unit(c(0.2,0.25,0.2,0.5), "cm")),
ncol = 2, labels = c('(A)', "(B)"))
bottom_row<- plot_grid(NULL,Panel_C + theme(plot.margin = unit(c(0.2,0.25,0.2,0.5), "cm")),
ncol = 2, labels = c("(C)","x"))
plot_grid(upper_row, bottom_row, ncol = 1, rel_heights = c(1, 1))
dev.off()

group_by(layer_from, node_from, layer_to, node_to) %>%
summarise(sum_weight = sum(weight)) #turn sums of sites to sum of island
## ----dryad intralayer interlayer both ways-------------------------------------------------------------------------------------
intralayer_inverted <- tibble(values= dryad_intralayer_islands$layer_to, dryad_intralayer_islands$node_to, dryad_intralayer_islands$layer_from,
dryad_intralayer_islands$node_from, dryad_intralayer_islands$weight) #create an inverted copy for directed intralayers
colnames(intralayer_inverted) <- c("layer_from", "node_from", "layer_to", "node_to", "weight")
## ---- normalize intralayer weights--------------------------------------------------------------------------
#plants in from
tot_plant <- dryad_intralayer_islands %>%
group_by(layer_from,node_from) %>%
dplyr::summarise(tot=sum(weight))
intralayer_weighted <- dryad_intralayer_islands %>% left_join(tot_plant) %>% mutate(rel_weight=weight/tot) %>%
select(-weight,-tot) %>% dplyr::rename(weight=rel_weight)
#pols in from
tot_pol <- intralayer_inverted %>%
group_by(layer_from,node_from) %>%
dplyr::summarise(tot=sum(weight))
intralayer_weighted_inverted <- intralayer_inverted %>% left_join(tot_pol) %>% mutate(rel_weight=weight/tot) %>%
select(-weight,-tot) %>% dplyr::rename(weight=rel_weight)
#Create intraedgelist
edgelist_intralayers_both <- bind_rows(intralayer_weighted, intralayer_weighted_inverted) #combine inverted and non inverted versions of intra
##---- create interedges according to jaccard similarity between partners --------------------------------------------------------
# keep only species that occur in 2 or more layers
co_occurrence<- edgelist_intralayers_both%>%
group_by(node_from) %>%
mutate(num_layers_from=n_distinct(layer_from)) %>%
filter(num_layers_from>="2")
# a for loop that calculates all the interlayer edges based on jaccard index
interlayers_with_weights_islands <- NULL
for (i in unique(co_occurrence$node_from)) {
print(i)
partners_sp <-
co_occurrence %>%
filter(node_from== i) %>%
group_by(node_to) %>%
select(c(node_to,layer_from)) %>%
distinct() %>%
mutate(present=1) %>%
spread(node_to, present, fill = 0) %>%
column_to_rownames("layer_from")
beta_layers_sp <- 1-as.matrix(vegdist(partners_sp, "jaccard"))
beta_layers_sp_m <- melt(as.matrix(extRC::tril(beta_layers_sp)))
inter_fid <- beta_layers_sp_m  %>%
tibble() %>%
filter(value!=0) %>%
subset(Var1 != Var2) %>%
mutate(node_from=i, node_to =i) %>%
select(c(node_from,layer_from=Var1, layer_to=Var2,node_to, weight=value))
interlayers_with_weights_islands <- rbind(interlayers_with_weights_islands,inter_fid)
}
interlayers_with_weights_islands<-interlayers_with_weights_islands[,c(2,1,3,4,5)]#change order columns
#inverted version
interlayer_inverted <- tibble(values= interlayers_with_weights_islands$layer_to, interlayers_with_weights_islands$node_to, interlayers_with_weights_islands$layer_from,
interlayers_with_weights_islands$node_from, interlayers_with_weights_islands$weight) #create an inverted copy for directed intralayers
colnames(interlayer_inverted) <- c("layer_from", "node_from", "layer_to", "node_to", "weight")
#Create interedgelist
edgelist_interlayers_both <- bind_rows(interlayers_with_weights_islands, interlayer_inverted) #combine inverted and non inverted versions of intra
## ----multilayer_extended_final--------------------------------------------------------------------------------------
dryad_edgelist_complete <- bind_rows(edgelist_intralayers_both, edgelist_interlayers_both) #combine weighted version of intra with inter
## ----node_metadata--------------------------------------------------------------------------------------------------
pollinators <- sort(unique(intralayer_weighted$node_to)) #adding up only pol who haven't been added yet
plants <- sort(unique(intralayer_weighted$node_from)) #adding up only plants who haven't been added yet
intersect(pollinators, plants) #making sure I don't have plants in pol or other way around
A <- length(pollinators) # Number of pollinators
P <- length(plants) # Number of plants
S <- A+P
island_names <- c("WesternSahara", #islands as layers
"Fuerteventura",
"GranCanaria",
"TenerifeSouth",
"TenerifeTeno",
"Gomera",
"Hierro")
# Create a table with node metadata
physical_nodes <- tibble(node_id=1:S, #1 till the last species
type=c(rep('plant',P),rep('pollinator',A)), #replicate the words P and A times
species=c(plants,pollinators)) #add species from plants and pollinators in accordance
layer_metadata <- tibble(layer_id=c(1:7), layer_name=island_names)  #give num to each layer
# Replace the node names with node_ids
dryad_edgelist_complete_ids <-
dryad_edgelist_complete %>%
left_join(physical_nodes, by=c('node_from' = 'species')) %>%  # Join for pollinators
left_join(physical_nodes, by=c('node_to' = 'species')) %>%  # Join for plants
dplyr::select(-node_from, -node_to) %>% #choose said columns
dplyr::select(layer_from, node_from=node_id.x, layer_to, node_to=node_id.y, weight) %>%
left_join(layer_metadata, by=c('layer_from' = 'layer_name')) %>%  # Join for plants
left_join(layer_metadata, by=c('layer_to' = 'layer_name')) %>%  # Join for plants
dplyr::select(-layer_from, -layer_to) %>%
dplyr::select(layer_from=layer_id.x, node_from, layer_to=layer_id.y, node_to, weight)
#Plot links distribution (directed)
inter_extended<- dryad_edgelist_complete_ids %>% filter(layer_from!=layer_to)
intra_inter_data_for_distibution <- data.frame(values= c(intralayer_weighted$weight,
intralayer_weighted_inverted$weight,
inter_extended$weight),
group= c(rep("intra plants", nrow(intralayer_weighted)),
rep("intra pollinators", nrow(intralayer_weighted_inverted)),
rep("inter", nrow(inter_extended))))
intra_inter_data_for_distibution %>%
ggplot(aes(x=values, fill=group))+ geom_histogram(position= "identity", alpha= 0.6, color= "black")+ theme_bw()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=14, color='black'),
axis.title = element_text(size=14, color='black'),
axis.line = element_blank())
intra_inter_data_for_distibution %>%
ggplot(aes(x=values, fill=group))+ geom_histogram(position= "identity", alpha= 0.6, color= "black")+
labs(x='Weight', y="Count") +theme_bw()+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
intra_inter_data_for_distibution %>%
ggplot(aes(x=values, fill=group))+ geom_histogram(position= "identity", alpha= 0.6, color= "black")+
labs(x='Weight', y="Count") +theme_bw()+
scale_fill_manual(name = "Links",  label = c("Inter","Intralinks \nplants", "Intralinks \npol"))+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
intra_inter_data_for_distibution %>%
ggplot(aes(x=values, fill=group))+ geom_histogram(position= "identity", alpha= 0.6, color= "black")+
labs(x='Weight', y="Count") +theme_bw()+
scale_fill_manual(name = "Links",  label = c("Inter","Intralinks \nplants", "Intralinks \npol"), values = c("#fbd2d2","#008000","#BE75FA"))+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
intra_inter_data_for_distibution %>%
ggplot(aes(x=values, fill=group))+ geom_histogram(position= "identity", alpha= 0.5, color= "black")+
labs(x='Weight', y="Count") +theme_bw()+
scale_fill_manual(name = "Links",  label = c("Interlayer","Intralayer \nplants", "Intralayer \npol"), values = c("#fbd2d2","#008000","#BE75FA"))+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
intra_inter_data_for_distibution %>%
ggplot(aes(x=values, fill=group))+ geom_histogram(position= "identity", alpha= 0.2, color= "black")+
labs(x='Weight', y="Count") +theme_bw()+
scale_fill_manual(name = "Links",  label = c("Interlayer","Intralayer \nplants", "Intralayer \npol"), values = c("#fbd2d2","#008000","#BE75FA"))+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
intra_inter_data_for_distibution %>%
ggplot(aes(x=values, fill=group))+ geom_histogram(position= "identity", alpha= 0.5, color= "black")+
labs(x='Weight', y="Count") +theme_bw()+
scale_fill_manual(name = "Links",  label = c("Interlayer","Intralayer \nplants", "Intralayer \npol"), values = c("#fbd2d2","#008000","#BE75FA"))+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
intra_inter_data_for_distibution %>%
ggplot(aes(x=values, fill=group))+ geom_histogram(position= "identity", alpha= 0.5, color= "black")+
labs(x='Weight', y="Count") +theme_bw()+
scale_fill_manual(name = "Links",  label = c("Interlayer","Intralayer \nplants", "Intralayer \npol"), values = c("red","#008000","#BE75FA"))+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
intra_inter_data_for_distibution %>%
ggplot(aes(x=values, fill=group))+ geom_histogram(position= "identity", alpha= 0.5, color= "black")+
labs(x='Weight', y="Count") +theme_bw()+
scale_fill_manual(name = "Links",  label = c("Interlayer","Intralayer \nplants", "Intralayer \npol"), values = c("#331940","#008000","#BE75FA"))+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
intra_inter_data_for_distibution %>%
ggplot(aes(x=values, fill=group))+ geom_histogram(position= "identity", alpha= 0.5, color= "black")+
labs(x='Weight', y="Count") +theme_bw()+
scale_fill_manual(name = "Links",  label = c("Interlayer","Intralayer \nplants", "Intralayer \npol"), values = c("#458CFF","#008000","#BE75FA"))+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
intra_inter_data_for_distibution %>%
ggplot(aes(x=values, fill=group))+ geom_histogram(position= "identity", alpha= 0.7, color= "black")+
labs(x='Weight', y="Count") +theme_bw()+
scale_fill_manual(name = "Links",  label = c("Interlayer","Intralayer \nplants", "Intralayer \npol"), values = c("#458CFF","#008000","#BE75FA"))+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
intra_inter_data_for_distibution %>%
ggplot(aes(x=values, fill=group))+ geom_histogram(position= "identity", alpha= 0.65, color= "black")+
labs(x='Weight', y="Count") +theme_bw()+
scale_fill_manual(name = "Links",  label = c("Interlayer","Intralayer \nplants", "Intralayer \npol"), values = c("#458CFF","#008000","#BE75FA"))+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
intra_inter_data_for_distibution %>%
ggplot(aes(x=values, fill=group))+ geom_histogram(position= "identity", alpha= 0.65, color= "black")+
labs(x='Weight', y="Count") +theme_bw()+
scale_fill_manual(name = "Links",  label = c("Interlayer","Intralayer \nplants", "Intralayer \npol"), values = c("#458CFF","#008000","#CBA2F5"))+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
intra_inter_data_for_distibution %>%
ggplot(aes(x=values, fill=group))+ geom_histogram(position= "identity", alpha= 0.7, color= "black")+
labs(x='Weight', y="Count") +theme_bw()+
scale_fill_manual(name = "Links",  label = c("Interlayer","Intralayer \nplants", "Intralayer \npol"), values = c("#3340F5","#008000","#CBA2F5"))+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
intra_inter_data_for_distibution %>%
ggplot(aes(x=values, fill=group))+ geom_histogram(position= "identity", alpha= 0.7, color= "black")+
labs(x='Weight', y="Count") +theme_bw()+
scale_fill_manual(name = "Links",  label = c("Interlayer","Intralayer \nplants", "Intralayer \npol"), values = c("#458CFF","#008000","#CBA2F5"))+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
intra_inter_data_for_distibution %>%
ggplot(aes(x=values, fill=group))+ geom_histogram(position= "identity", alpha= 0.7, color= "black")+
labs(x='Weight', y="Count") +theme_bw()+
scale_fill_manual(name = "Links",  label = c("Interlayer","Intralayer \nplants", "Intralayer \npol"), values = c("#0072F5","#008000","#CBA2F5"))+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
intra_inter_data_for_distibution %>%
ggplot(aes(x=values, fill=group))+ geom_histogram(position= "identity", alpha= 0.6, color= "black")+
labs(x='Weight', y="Count") +theme_bw()+
scale_fill_manual(name = "Links",  label = c("Interlayer","Intralayer \nplants", "Intralayer \npol"), values = c("#0072F5","#008000","#CBA2F5"))+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
intra_inter_data_for_distibution %>%
ggplot(aes(x=values, fill=group))+ geom_histogram(position= "identity", alpha= 0.6, color= "black")+
labs(x='Weight', y="Count") +theme_bw()+
scale_fill_manual(name = "Links",  label = c("Interlayer","Intralayer \nplants", "Intralayer \npol"), values = c("#073FF5","#008000","#BE75FA"))+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
intra_inter_data_for_distibution %>%
ggplot(aes(x=values, fill=group))+ geom_histogram(position= "identity", alpha= 0.6, color= "black")+
labs(x='Weight', y="Count") +theme_bw()+
scale_fill_manual(name = "Links",  label = c("Interlayer","Intralayer \nplants", "Intralayer \npol"), values = c("#0008F5","#008000","#BE75FA"))+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
intra_inter_data_for_distibution %>%
ggplot(aes(x=values, fill=group))+ geom_histogram(position= "identity", alpha= 0.6, color= "black")+
labs(x='Weight', y="Count") +theme_bw()+
scale_fill_manual(name = "Links",  label = c("Interlayer","Intralayer \nplants", "Intralayer \npol"), values = c("red","#008000","#BE75FA"))+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
intra_inter_data_for_distibution %>%
ggplot(aes(x=values, fill=group))+ geom_histogram(position= "identity", alpha= 0.6, color= "black")+
labs(x='Weight', y="Count") +theme_bw()+
scale_fill_manual(name = "Links",  label = c("Interlayer","Intralayer \nplants", "Intralayer \npol"), values = c("#F53416","#008000","#BE75FA"))+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
intra_inter_data_for_distibution %>%
ggplot(aes(x=values, fill=group))+ geom_histogram(position= "identity", alpha= 0.8, color= "black")+
labs(x='Weight', y="Count") +theme_bw()+
scale_fill_manual(name = "Links",  label = c("Interlayer","Intralayer \nplants", "Intralayer \npol"), values = c("#F53416","#008000","#BE75FA"))+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
intra_inter_data_for_distibution %>%
ggplot(aes(x=values, fill=group))+ geom_histogram(position= "identity", alpha= 0.75, color= "black")+
labs(x='Weight', y="Count") +theme_bw()+
scale_fill_manual(name = "Links",  label = c("Interlayer","Intralayer \nplants", "Intralayer \npol"), values = c("#F53416","#008000","#BE75FA"))+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
intra_inter_data_for_distibution %>%
ggplot(aes(x=values, fill=group))+ geom_histogram(position= "identity", alpha= 0.75, color= "black")+
labs(x='Weight', y="Count") +theme_bw()+
scale_fill_manual(name = "Links",  label = c("Interlayer","Intralayer \nplants", "Intralayer \npol"), values = c("#F53416","#008000","#C994FF"))+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
intra_inter_data_for_distibution %>%
ggplot(aes(x=values, fill=group))+ geom_histogram(position= "identity", alpha= 0.70, color= "black")+
labs(x='Weight', y="Count") +theme_bw()+
scale_fill_manual(name = "Links",  label = c("Interlayer","Intralayer \nplants", "Intralayer \npol"), values = c("#F53416","#008000","#C994FF"))+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
intra_inter_data_for_distibution %>%
ggplot(aes(x=values, fill=group))+ geom_histogram(position= "identity", alpha= 0.70, color= "black")+
labs(x='Weight', y="Count") +theme_bw()+
scale_fill_manual(name = "Links",  label = c("Interlayer","Intralayer \nplants", "Intralayer \npol"), values = c("#F53416","#008000","#DFCFFF"))+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
intra_inter_data_for_distibution %>%
ggplot(aes(x=values, fill=group))+ geom_histogram(position= "identity", alpha= 0.70, color= "black")+
labs(x='Weight', y="Count") +theme_bw()+
scale_fill_manual(name = "Links",  label = c("Interlayer","Intralayer \nplants", "Intralayer \npol"), values = c("#F53416","#008000","#C1A1E3"))+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
intra_inter_data_for_distibution %>%
ggplot(aes(x=values, fill=group))+ geom_histogram(position= "identity", alpha= 0.70, color= "black")+
labs(x='Weight', y="Count") +theme_bw()+
scale_fill_manual(name = "Links",  label = c("Interlayer","Intralayer \nplants", "Intralayer \npol"), values = c("#F53416","#008000","#D4B8FF"))+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
intra_inter_data_for_distibution %>%
ggplot(aes(x=values, fill=group))+ geom_histogram(position= "identity", alpha= 0.70, color= "black")+
labs(x='Weight', y="Count") +theme_bw()+
scale_fill_manual(name = "Links",  label = c("Interlayer","Intralayer \nplants", "Intralayer \npol"), values = c("#F53416","#008000","#CBADFF"))+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
pdf('./graphs/Islands/Jac/intra and interlinks_islands_jaccard.pdf', 10, 6)
intra_inter_data_for_distibution %>%
ggplot(aes(x=values, fill=group))+ geom_histogram(position= "identity", alpha= 0.70, color= "black")+
labs(x='Weight', y="Count") +theme_bw()+
scale_fill_manual(name = "Links",  label = c("Interlayer","Intralayer \nplants", "Intralayer \npol"), values = c("#F53416","#008000","#CBADFF"))+
theme_classic()+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
dev.off()

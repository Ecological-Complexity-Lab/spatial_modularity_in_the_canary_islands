edge_list_with_distances_shuf <- right_join(modules_edge_list_shuf, distances_with_ids, by= c("layer_from", "layer_to")) #combine the edge list with the distances between each two layers
#edge_list_with_distances_shuf <- na.omit(edge_list_with_distances_shuf) #we remove this line (which it removes NA), because we have a lot locations don't have modules in common
for (i in 1:6){
for (j in (i+1):7){
modules_in_layer_from_shuf <- filter(modules_for_similarity_shuf, layer_id == i) %>% select(module) %>% unique() %>% unlist()
modules_in_layer_to_shuf <- filter(modules_for_similarity_shuf, layer_id == j) %>% select(module) %>% unique() %>% unlist()
#take all nodes in layer_from and all nodes in layer_to to check turnover
int_both <- intersect(modules_in_layer_from_shuf, modules_in_layer_to_shuf) #how many nodes are found in both layers
uni_both <- union(modules_in_layer_from_shuf, modules_in_layer_to_shuf)
turnover <- length(int_both)/length(uni_both)
module_layer_turnover_shuf <- rbind(module_layer_turnover_shuf,
tibble(layer_from = i, layer_to = j, turnover = turnover, trial = trial))
}
}
layers_turnover_with_distnace <- edge_list_with_distances_shuf %>%
merge(module_layer_turnover_shuf, by= c("layer_from", "layer_to")) #merge both versions
}
return(layers_turnover_with_distnace)
}
edge_list_per_module_islands <- function(data,edge_list){
#gets one row from a data frame and creates an edge list from it
for (i in (1:6)){
if (data[i]==0) next #only take layers where the module is present
else {
for (j in ((i+1):7)){
if (data[j]==0) next #only take layers where the module is present
else {
edge_list <-rbind(edge_list,tibble(layer_from=i, layer_to=j, module=as.character(NA))) #create edge list of all the layer found in a module
}
}
}
}
return(edge_list)
}
turnover_with_distance_pols <- NULL
turnover_with_distance_plants <- NULL
turnover_with_distance_both <- NULL
module_layer_turnover_shuf <- NULL
layers_turnover_with_distnace<-NULL
#shuff pols
all_edge_list_layer_combine_no_module_shuf_pols_output <- module_distance_decay_islands_func(dryad_multilayer_shuf_1000_pols_output,
turnover_with_distance_pols)
View(all_edge_list_layer_combine_no_module_shuf_pols_output)
comb<-all_edge_list_layer_combine_no_module_shuf_pols_output %>% arrange(trial)
View(comb)
# this function calculates the Jaccard Similarity in modules between islands
module_distance_decay_islands_func <- function(multilayer_1000,
layers_turnover_with_distnace){
for (trial in 1){
print(trial) #to keep tab on how far along we are
modules_for_similarity_shuf <- multilayer_1000  %>% filter(trial_num ==trial) #take only 1 trial
#pivot modules
module_pivoted_shuf <- pivot_by_module_islands(modules_for_similarity_shuf) #pivot will be done on 1 trial each time
#create edge list with distances
modules_edge_list_shuf <- NULL
for (k in (1:nrow(module_pivoted_shuf))){ #run the function for each row in the data frame
modules_edge_list_shuf <- edge_list_per_module_islands(module_pivoted_shuf[k,], modules_edge_list_shuf)
current_module <- rownames(module_pivoted_shuf)[k]
if (is.null(modules_edge_list_shuf)) next
modules_edge_list_shuf <- modules_edge_list_shuf %>% mutate(module = replace_na(module, current_module)) #add module number
}
edge_list_with_distances_shuf <- right_join(modules_edge_list_shuf, distances_with_ids, by= c("layer_from", "layer_to")) #combine the edge list with the distances between each two layers
#edge_list_with_distances_shuf <- na.omit(edge_list_with_distances_shuf) #we remove this line (which it removes NA), because we have a lot locations don't have modules in common
for (i in 1:6){
for (j in (i+1):7){
modules_in_layer_from_shuf <- filter(modules_for_similarity_shuf, layer_id == i) %>% select(module) %>% unique() %>% unlist()
modules_in_layer_to_shuf <- filter(modules_for_similarity_shuf, layer_id == j) %>% select(module) %>% unique() %>% unlist()
#take all nodes in layer_from and all nodes in layer_to to check turnover
int_both <- intersect(modules_in_layer_from_shuf, modules_in_layer_to_shuf) #how many nodes are found in both layers
uni_both <- union(modules_in_layer_from_shuf, modules_in_layer_to_shuf)
turnover <- length(int_both)/length(uni_both)
module_layer_turnover_shuf <- rbind(module_layer_turnover_shuf,
tibble(layer_from = i, layer_to = j, turnover = turnover, trial = trial))
}
}
layers_turnover_with_distnace <- edge_list_with_distances_shuf %>%
merge(module_layer_turnover_shuf, by= c("layer_from", "layer_to")) #merge both versions
}
return(layers_turnover_with_distnace)
}
#shuff pols
all_edge_list_layer_combine_no_module_shuf_pols_output <- module_distance_decay_islands_func(dryad_multilayer_shuf_1000_pols_output,
turnover_with_distance_pols)
res1<-all_edge_list_layer_combine_no_module_shuf_pols_output
# this function calculates the Jaccard Similarity in modules between islands
module_distance_decay_islands_func <- function(multilayer_1000,
layers_turnover_with_distnace){
for (trial in 2){
print(trial) #to keep tab on how far along we are
modules_for_similarity_shuf <- multilayer_1000  %>% filter(trial_num ==trial) #take only 1 trial
#pivot modules
module_pivoted_shuf <- pivot_by_module_islands(modules_for_similarity_shuf) #pivot will be done on 1 trial each time
#create edge list with distances
modules_edge_list_shuf <- NULL
for (k in (1:nrow(module_pivoted_shuf))){ #run the function for each row in the data frame
modules_edge_list_shuf <- edge_list_per_module_islands(module_pivoted_shuf[k,], modules_edge_list_shuf)
current_module <- rownames(module_pivoted_shuf)[k]
if (is.null(modules_edge_list_shuf)) next
modules_edge_list_shuf <- modules_edge_list_shuf %>% mutate(module = replace_na(module, current_module)) #add module number
}
edge_list_with_distances_shuf <- right_join(modules_edge_list_shuf, distances_with_ids, by= c("layer_from", "layer_to")) #combine the edge list with the distances between each two layers
#edge_list_with_distances_shuf <- na.omit(edge_list_with_distances_shuf) #we remove this line (which it removes NA), because we have a lot locations don't have modules in common
for (i in 1:6){
for (j in (i+1):7){
modules_in_layer_from_shuf <- filter(modules_for_similarity_shuf, layer_id == i) %>% select(module) %>% unique() %>% unlist()
modules_in_layer_to_shuf <- filter(modules_for_similarity_shuf, layer_id == j) %>% select(module) %>% unique() %>% unlist()
#take all nodes in layer_from and all nodes in layer_to to check turnover
int_both <- intersect(modules_in_layer_from_shuf, modules_in_layer_to_shuf) #how many nodes are found in both layers
uni_both <- union(modules_in_layer_from_shuf, modules_in_layer_to_shuf)
turnover <- length(int_both)/length(uni_both)
module_layer_turnover_shuf <- rbind(module_layer_turnover_shuf,
tibble(layer_from = i, layer_to = j, turnover = turnover, trial = trial))
}
}
layers_turnover_with_distnace <- edge_list_with_distances_shuf %>%
merge(module_layer_turnover_shuf, by= c("layer_from", "layer_to")) #merge both versions
}
return(layers_turnover_with_distnace)
}
#shuff pols
all_edge_list_layer_combine_no_module_shuf_pols_output <- module_distance_decay_islands_func(dryad_multilayer_shuf_1000_pols_output,
turnover_with_distance_pols)
res2<-all_edge_list_layer_combine_no_module_shuf_pols_output
# this function calculates the Jaccard Similarity in modules between islands
module_distance_decay_islands_func <- function(multilayer_1000,
layers_turnover_with_distnace){
for (trial in 3){
print(trial) #to keep tab on how far along we are
modules_for_similarity_shuf <- multilayer_1000  %>% filter(trial_num ==trial) #take only 1 trial
#pivot modules
module_pivoted_shuf <- pivot_by_module_islands(modules_for_similarity_shuf) #pivot will be done on 1 trial each time
#create edge list with distances
modules_edge_list_shuf <- NULL
for (k in (1:nrow(module_pivoted_shuf))){ #run the function for each row in the data frame
modules_edge_list_shuf <- edge_list_per_module_islands(module_pivoted_shuf[k,], modules_edge_list_shuf)
current_module <- rownames(module_pivoted_shuf)[k]
if (is.null(modules_edge_list_shuf)) next
modules_edge_list_shuf <- modules_edge_list_shuf %>% mutate(module = replace_na(module, current_module)) #add module number
}
edge_list_with_distances_shuf <- right_join(modules_edge_list_shuf, distances_with_ids, by= c("layer_from", "layer_to")) #combine the edge list with the distances between each two layers
#edge_list_with_distances_shuf <- na.omit(edge_list_with_distances_shuf) #we remove this line (which it removes NA), because we have a lot locations don't have modules in common
for (i in 1:6){
for (j in (i+1):7){
modules_in_layer_from_shuf <- filter(modules_for_similarity_shuf, layer_id == i) %>% select(module) %>% unique() %>% unlist()
modules_in_layer_to_shuf <- filter(modules_for_similarity_shuf, layer_id == j) %>% select(module) %>% unique() %>% unlist()
#take all nodes in layer_from and all nodes in layer_to to check turnover
int_both <- intersect(modules_in_layer_from_shuf, modules_in_layer_to_shuf) #how many nodes are found in both layers
uni_both <- union(modules_in_layer_from_shuf, modules_in_layer_to_shuf)
turnover <- length(int_both)/length(uni_both)
module_layer_turnover_shuf <- rbind(module_layer_turnover_shuf,
tibble(layer_from = i, layer_to = j, turnover = turnover, trial = trial))
}
}
layers_turnover_with_distnace <- edge_list_with_distances_shuf %>%
merge(module_layer_turnover_shuf, by= c("layer_from", "layer_to")) #merge both versions
}
return(layers_turnover_with_distnace)
}
#shuff pols
all_edge_list_layer_combine_no_module_shuf_pols_output <- module_distance_decay_islands_func(dryad_multilayer_shuf_1000_pols_output,
turnover_with_distance_pols)
res3<-all_edge_list_layer_combine_no_module_shuf_pols_output
View(res1)
View(res2)
View(res3)
nuevca<-cbind(res1,res2,res3)
nuevca<-rbind(res1,res2,res3)
nuevca$turnover==comb$turnover
# this function calculates the Jaccard Similarity in modules between islands
module_distance_decay_islands_func <- function(multilayer_1000,
layers_turnover_with_distnace){
for (trial in 3){
print(trial) #to keep tab on how far along we are
modules_for_similarity_shuf <- multilayer_1000  %>% filter(trial_num ==trial) #take only 1 trial
#pivot modules
module_pivoted_shuf <- pivot_by_module_islands(modules_for_similarity_shuf) #pivot will be done on 1 trial each time
#create edge list with distances
modules_edge_list_shuf <- NULL
for (k in (1:nrow(module_pivoted_shuf))){ #run the function for each row in the data frame
modules_edge_list_shuf <- edge_list_per_module_islands(module_pivoted_shuf[k,], modules_edge_list_shuf)
current_module <- rownames(module_pivoted_shuf)[k]
if (is.null(modules_edge_list_shuf)) next
modules_edge_list_shuf <- modules_edge_list_shuf %>% mutate(module = replace_na(module, current_module)) #add module number
}
edge_list_with_distances_shuf <- right_join(modules_edge_list_shuf, distances_with_ids, by= c("layer_from", "layer_to")) #combine the edge list with the distances between each two layers
edge_list_with_distances_shuf <- na.omit(edge_list_with_distances_shuf) #we remove this line (which it removes NA), because we have a lot locations don't have modules in common
for (i in 1:6){
for (j in (i+1):7){
modules_in_layer_from_shuf <- filter(modules_for_similarity_shuf, layer_id == i) %>% select(module) %>% unique() %>% unlist()
modules_in_layer_to_shuf <- filter(modules_for_similarity_shuf, layer_id == j) %>% select(module) %>% unique() %>% unlist()
#take all nodes in layer_from and all nodes in layer_to to check turnover
int_both <- intersect(modules_in_layer_from_shuf, modules_in_layer_to_shuf) #how many nodes are found in both layers
uni_both <- union(modules_in_layer_from_shuf, modules_in_layer_to_shuf)
turnover <- length(int_both)/length(uni_both)
module_layer_turnover_shuf <- rbind(module_layer_turnover_shuf,
tibble(layer_from = i, layer_to = j, turnover = turnover, trial = trial))
}
}
layers_turnover_with_distnace <- edge_list_with_distances_shuf %>%
merge(module_layer_turnover_shuf, by= c("layer_from", "layer_to")) #merge both versions
}
return(layers_turnover_with_distnace)
}
#shuff pols
all_edge_list_layer_combine_no_module_shuf_pols_output <- module_distance_decay_islands_func(dryad_multilayer_shuf_1000_pols_output,
turnover_with_distance_pols)
View(all_edge_list_layer_combine_no_module_shuf_pols_output)
# this function calculates the Jaccard Similarity in modules between islands
module_distance_decay_islands_func <- function(multilayer_1000,
layers_turnover_with_distnace){
for (trial in 1:2){
print(trial) #to keep tab on how far along we are
modules_for_similarity_shuf <- multilayer_1000  %>% filter(trial_num ==trial) #take only 1 trial
#pivot modules
module_pivoted_shuf <- pivot_by_module_islands(modules_for_similarity_shuf) #pivot will be done on 1 trial each time
#create edge list with distances
modules_edge_list_shuf <- NULL
for (k in (1:nrow(module_pivoted_shuf))){ #run the function for each row in the data frame
modules_edge_list_shuf <- edge_list_per_module_islands(module_pivoted_shuf[k,], modules_edge_list_shuf)
current_module <- rownames(module_pivoted_shuf)[k]
if (is.null(modules_edge_list_shuf)) next
modules_edge_list_shuf <- modules_edge_list_shuf %>% mutate(module = replace_na(module, current_module)) #add module number
}
edge_list_with_distances_shuf <- right_join(modules_edge_list_shuf, distances_with_ids, by= c("layer_from", "layer_to")) #combine the edge list with the distances between each two layers
#edge_list_with_distances_shuf <- na.omit(edge_list_with_distances_shuf) #we remove this line (which it removes NA), because we have a lot locations don't have modules in common
for (i in 1:6){
for (j in (i+1):7){
modules_in_layer_from_shuf <- filter(modules_for_similarity_shuf, layer_id == i) %>% select(module) %>% unique() %>% unlist()
modules_in_layer_to_shuf <- filter(modules_for_similarity_shuf, layer_id == j) %>% select(module) %>% unique() %>% unlist()
#take all nodes in layer_from and all nodes in layer_to to check turnover
int_both <- intersect(modules_in_layer_from_shuf, modules_in_layer_to_shuf) #how many nodes are found in both layers
uni_both <- union(modules_in_layer_from_shuf, modules_in_layer_to_shuf)
turnover <- length(int_both)/length(uni_both)
module_layer_turnover_shuf <- rbind(module_layer_turnover_shuf,
tibble(layer_from = i, layer_to = j, turnover = turnover, trial = trial))
}
}
layers_turnover_with_distnace <- edge_list_with_distances_shuf %>%
merge(module_layer_turnover_shuf, by= c("layer_from", "layer_to")) #merge both versions
}
return(layers_turnover_with_distnace)
}
#shuff pols
all_edge_list_layer_combine_no_module_shuf_pols_output <- module_distance_decay_islands_func(dryad_multilayer_shuf_1000_pols_output,
turnover_with_distance_pols)
comb<-all_edge_list_layer_combine_no_module_shuf_pols_output %>% arrange(trial)
View(res1)
View(res2)
##---- Distance decay of modules  ---------------------------------------------------------------
distances_with_ids <- read.csv("./csvs/Islands/distances_with_ids_islands_as_layers.csv")
#pivot modules function for islands as layers
pivot_by_module_islands <- function(data){ #creates a data frame with module on the side and layer_id on the top
s1 = melt(data , id = c("layer_id", "module"))
s2 = dcast(s1, layer_id ~ module, length)
s2<-na.omit(s2)
s4 = t(s2)
s4 <- s4[-1,]
colnames(s4) <- c(1,2,3,4,5,6,7)
return(s4)
}
# this function calculates the Jaccard Similarity in modules between islands
module_distance_decay_islands_func <- function(multilayer_1000,
layers_turnover_with_distnace){
for (trial in 1:1000){
print(trial) #to keep tab on how far along we are
modules_for_similarity_shuf <- multilayer_1000  %>% filter(trial_num ==trial) #take only 1 trial
#pivot modules
module_pivoted_shuf <- pivot_by_module_islands(modules_for_similarity_shuf) #pivot will be done on 1 trial each time
#create edge list with distances
modules_edge_list_shuf <- NULL
for (k in (1:nrow(module_pivoted_shuf))){ #run the function for each row in the data frame
modules_edge_list_shuf <- edge_list_per_module_islands(module_pivoted_shuf[k,], modules_edge_list_shuf)
current_module <- rownames(module_pivoted_shuf)[k]
if (is.null(modules_edge_list_shuf)) next
modules_edge_list_shuf <- modules_edge_list_shuf %>% mutate(module = replace_na(module, current_module)) #add module number
}
edge_list_with_distances_shuf <- right_join(modules_edge_list_shuf, distances_with_ids, by= c("layer_from", "layer_to")) #combine the edge list with the distances between each two layers
#edge_list_with_distances_shuf <- na.omit(edge_list_with_distances_shuf) #we remove this line (which it removes NA), because we have a lot locations don't have modules in common
for (i in 1:6){
for (j in (i+1):7){
modules_in_layer_from_shuf <- filter(modules_for_similarity_shuf, layer_id == i) %>% select(module) %>% unique() %>% unlist()
modules_in_layer_to_shuf <- filter(modules_for_similarity_shuf, layer_id == j) %>% select(module) %>% unique() %>% unlist()
#take all nodes in layer_from and all nodes in layer_to to check turnover
int_both <- intersect(modules_in_layer_from_shuf, modules_in_layer_to_shuf) #how many nodes are found in both layers
uni_both <- union(modules_in_layer_from_shuf, modules_in_layer_to_shuf)
turnover <- length(int_both)/length(uni_both)
module_layer_turnover_shuf <- rbind(module_layer_turnover_shuf,
tibble(layer_from = i, layer_to = j, turnover = turnover, trial = trial))
}
}
layers_turnover_with_distnace <- edge_list_with_distances_shuf %>%
merge(module_layer_turnover_shuf, by= c("layer_from", "layer_to")) #merge both versions
}
return(layers_turnover_with_distnace)
}
turnover_with_distance_pols <- NULL
turnover_with_distance_plants <- NULL
turnover_with_distance_both <- NULL
module_layer_turnover_shuf <- NULL
layers_turnover_with_distnace<-NULL
#shuff pols
all_edge_list_layer_combine_no_module_shuf_pols_output <- module_distance_decay_islands_func(dryad_multilayer_shuf_1000_pols_output,
turnover_with_distance_pols)
View(all_edge_list_layer_combine_no_module_shuf_pols_output)
write.csv(all_edge_list_layer_combine_no_module_shuf_pols_output, "./csvs/Islands/Jac/all_edge_list_layer_combine_no_module_shuf_pols_output_islands.csv", row.names = FALSE)
dryad_multilayer_shuf_1000_plants_output <- read.csv("./csvs/Islands/Jac/dryad_multilayer_shuf_1000_plants_output_islands_as_layers.csv")
turnover_with_distance_pols <- NULL
turnover_with_distance_plants <- NULL
turnover_with_distance_both <- NULL
module_layer_turnover_shuf <- NULL
layers_turnover_with_distnace<-NULL
#shuff plants
all_edge_list_layer_combine_no_module_shuf_plants_output <- module_distance_decay_islands_func(dryad_multilayer_shuf_1000_plants_output,
turnover_with_distance_plants)
View(all_edge_list_layer_combine_no_module_shuf_plants_output)
View(all_edge_list_layer_combine_no_module_shuf_plants_output)
write.csv(ave_module_layer_turnover_shuf_plants, "./csvs/Islands/Jac/ave_module_layer_turnover_shuf_plants_islands.csv", row.names = FALSE)
write.csv(all_edge_list_layer_combine_no_module_shuf_plants_output,  "./csvs/Islands/Jac/all_edge_list_layer_combine_no_module_shuf_plants_output_islands.csv", row.names = FALSE)
dryad_multilayer_shuf_1000_both_output <- read.csv("./csvs/Islands/Jac/dryad_multilayer_shuf_1000_both_output_islands_as_layers.csv")
#shuff both
all_edge_list_layer_combine_no_module_shuf_both_output <- module_distance_decay_islands_func(dryad_multilayer_shuf_1000_both_output,
turnover_with_distance_both)
write.csv(all_edge_list_layer_combine_no_module_shuf_both_output, "./csvs/Islands/Jac/all_edge_list_layer_combine_no_module_shuf_both_output_islands.csv", row.names = FALSE)
#---- create ave for jaccard islands -------------------------------------------------------------------------
#pols
ave_module_layer_turnover_shuf_pols <- all_edge_list_layer_combine_no_module_shuf_pols_output %>%
group_by(layer_from, layer_to) %>%
summarise(ave = mean(turnover), sd = sd(turnover), mean_distance = mean(mean_distance)) %>% mutate(type="null_pollinators") #create mean and sd for each point
View(ave_module_layer_turnover_shuf_pols)
write.csv(ave_module_layer_turnover_shuf_pols, "./csvs/Islands/Jac/ave_module_layer_turnover_shuf_pols_islands.csv", row.names = FALSE)
#plants
ave_module_layer_turnover_shuf_plants <- all_edge_list_layer_combine_no_module_shuf_plants_output %>%
group_by(layer_from, layer_to) %>%
summarise(ave = mean(turnover), sd = sd(turnover), mean_distance = mean(mean_distance)) %>% mutate(type="null_plants") #create mean and sd for each point
View(ave_module_layer_turnover_shuf_pols)
write.csv(ave_module_layer_turnover_shuf_plants, "./csvs/Islands/Jac/ave_module_layer_turnover_shuf_plants_islands.csv", row.names = FALSE)
#both
ave_module_layer_turnover_shuf_both <- all_edge_list_layer_combine_no_module_shuf_both_output %>%
group_by(layer_from, layer_to) %>%
summarise(ave = mean(turnover), sd = sd(turnover), mean_distance = mean(mean_distance)) %>% mutate(type="null_both") #create mean and sd for each point
View(ave_module_layer_turnover_shuf_pols)
View(ave_module_layer_turnover_shuf_both)
write.csv(ave_module_layer_turnover_shuf_both,  "./csvs/Islands/Jac/ave_module_layer_turnover_shuf_both_islands.csv",  row.names = FALSE)
#add empirical
islands_turnover_with_distnace_empirical <- read.csv("csvs/Islands/Jac/islands_turnover_with_distnace_empirical.csv")
View(islands_turnover_with_distnace_empirical)
View(ave_module_layer_turnover_shuf_plants)
empirical_turnover_for_modules_layers_shuf <- islands_turnover_with_distnace_empirical %>% group_by(layer_from, layer_to) %>%
summarise(ave = mean(turnover), sd = sd(turnover), mean_distance = mean_distance) %>% mutate(type="empirical") #make sure sd is 0 cause its the empirical and not null
View(empirical_turnover_for_modules_layers_shuf)
#combine empirical and null
jaccard_similarity_islands_empirical_and_null <- rbind(empirical_turnover_for_modules_layers_shuf, ave_module_layer_turnover_shuf_pols,
ave_module_layer_turnover_shuf_plants, ave_module_layer_turnover_shuf_both)
jaccard_similarity_layer_empirical_and_null_km <- jaccard_similarity_islands_empirical_and_null %>%
mutate(mean_dist_in_km = mean_distance/1000)
View(jaccard_similarity_layer_empirical_and_null_km)
write.csv(jaccard_similarity_layer_empirical_and_null_km,  "./csvs/Islands/Jac/jaccard_similarity_layer_empirical_and_null_km_islands_m1.csv", row.names = FALSE)
#---- graphs for distance decay in modules shuf vs empirical--------------------------------
jaccard_similarity_layer_empirical_and_null_km <- read.csv("csvs/Islands/Jac/jaccard_similarity_layer_empirical_and_null_km_islands_m1.csv")
View(jaccard_similarity_layer_empirical_and_null_km)
jaccard_similarity_layer_empirical_and_null_km %>%
ggplot(aes(x= mean_dist_in_km, y= ave, group= type, color= type))+
geom_point()+ geom_errorbar(aes(ymin= ave-sd, ymax= ave+sd))+
labs(x="Distance (Km)", y="Jaccard Similarity")+
scale_color_manual(name = "Null Model",  labels = c("E",expression("M"[1]^P),expression("M"[1]^A),
expression("M"[1]^AP)), values = c("#FB3B1E", "#15B7BC", "#72A323", "#BE75FA" )) +
theme_classic()+ geom_smooth(method= "lm", se=F)+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
## check normality
emp<-jaccard_similarity_layer_empirical_and_null_km %>% filter(type=="empirical")
pol<-jaccard_similarity_layer_empirical_and_null_km %>% filter(type=="null_pollinators")
pla<-jaccard_similarity_layer_empirical_and_null_km %>% filter(type=="null_plants")
both<-jaccard_similarity_layer_empirical_and_null_km %>% filter(type=="null_both")
shapiro.test(emp$ave)
shapiro.test(pol$ave)#not normal
shapiro.test(pla$ave)
shapiro.test(both$ave)#not normal
max(emp$ave)
min(emp$ave)
##models
lm1_module = lm(ave ~ mean_dist_in_km ,data=emp) #in empirical
lm2_module = lm(ave ~ mean_dist_in_km ,data=pol) #in null pols
lm3_module = lm(ave ~ mean_dist_in_km ,data=pla) #in null plants
lm4_module = lm(ave ~ mean_dist_in_km ,data=both) #in null both
summary(lm1_module)
summary(lm2_module)
summary(lm2_module)
summary(lm3_module)
summary(lm4_module)
## check normality
emp<-jaccard_similarity_layer_empirical_and_null_km %>% filter(type=="empirical")
##models
lm1_module = lm(ave ~ mean_dist_in_km ,data=emp) #in empirical
summary(lm1_module)
lm2_module = lm(ave ~ mean_dist_in_km ,data=pol) #in null pols
summary(lm2_module)
lm3_module = lm(ave ~ mean_dist_in_km ,data=pla) #in null plants
summary(lm3_module)
jaccard_similarity_layer_empirical_and_null_km %>%
ggplot(aes(x= mean_dist_in_km, y= ave, group= type, color= type))+
geom_point()+ geom_errorbar(aes(ymin= ave-sd, ymax= ave+sd))+
labs(x="Distance (Km)", y="Jaccard Similarity")+
scale_color_manual(name = "Null Model",  labels = c("E",expression("M"[1]^P),expression("M"[1]^A),
expression("M"[1]^AP)), values = c("#FB3B1E",   "#72A323", "#15B7BC", "#BE75FA" )) +
theme_classic()+ geom_smooth(method= "lm", se=F)+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
##models
lm1_module = lm(ave ~ mean_dist_in_km ,data=emp) #in empirical
lm2_module = lm(ave ~ mean_dist_in_km ,data=pol) #in null pols
lm3_module = lm(ave ~ mean_dist_in_km ,data=pla) #in null plants
lm4_module = lm(ave ~ mean_dist_in_km ,data=both) #in null both
summary(lm1_module)
summary(lm2_module)
summary(lm3_module)
summary(lm4_module)
str(jaccard_similarity_layer_empirical_and_null_km)
jaccard_similarity_layer_empirical_and_null_km %>%
ggplot(aes(x= mean_dist_in_km, y= ave, group= type, color= type))+
geom_point()+ geom_errorbar(aes(ymin= ave-sd, ymax= ave+sd))+
labs(x="Distance (Km)", y="Jaccard Similarity")+
scale_color_manual(name = "Null Model",  labels = c("E",expression("M"[1]^P),expression("M"[1]^A),
expression("M"[1]^AP)),values = c("#FB3B1E", "#15B7BC",
"#72A323", "#BE75FA" )) +
theme_classic()+ geom_smooth(method= "lm", se=F)+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
lm2_module = lm(ave ~ mean_dist_in_km ,data=pol) #in null pols
lm3_module = lm(ave ~ mean_dist_in_km ,data=pla) #in null plants
lm4_module = lm(ave ~ mean_dist_in_km ,data=both) #in null both
summary(lm2_module)
summary(lm3_module)
jaccard_similarity_layer_empirical_and_null_km %>%
ggplot(aes(x= mean_dist_in_km, y= ave, group= type, color= type))+
geom_point()+ geom_errorbar(aes(ymin= ave-sd, ymax= ave+sd))+
labs(x="Distance (Km)", y="Jaccard Similarity")+
scale_color_manual(name = "Null Model",  labels = c("E",expression("M"[1]^A, expression("M"[1]^P)),
expression("M"[1]^AP)),values = c("#FB3B1E", "#15B7BC",
"#72A323", "#BE75FA" )) +
theme_classic()+ geom_smooth(method= "lm", se=F)+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
jaccard_similarity_layer_empirical_and_null_km %>%
ggplot(aes(x= mean_dist_in_km, y= ave, group= type, color= type))+
geom_point()+ geom_errorbar(aes(ymin= ave-sd, ymax= ave+sd))+
labs(x="Distance (Km)", y="Jaccard Similarity")+
scale_color_manual(name = "Null Model",  labels = c("E",expression("M"[1]^A), expression("M"[1]^P)),
expression("M"[1]^AP)),values = c("#FB3B1E", "#15B7BC",
"#72A323", "#BE75FA" )) +
theme_classic()+ geom_smooth(method= "lm", se=F)+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
jaccard_similarity_layer_empirical_and_null_km %>%
ggplot(aes(x= mean_dist_in_km, y= ave, group= type, color= type))+
geom_point()+ geom_errorbar(aes(ymin= ave-sd, ymax= ave+sd))+
labs(x="Distance (Km)", y="Jaccard Similarity")+
scale_color_manual(name = "Null Model",  labels = c("E",expression("M"[1]^A), expression("M"[1]^P),
expression("M"[1]^AP)),values = c("#FB3B1E", "#15B7BC",
"#72A323", "#BE75FA" )) +
theme_classic()+ geom_smooth(method= "lm", se=F)+
theme(panel.grid = element_blank(),
panel.border = element_rect(color = "black",fill = NA,size = 1),
panel.spacing = unit(0.5, "cm", data = NULL),
axis.text = element_text(size=15, color='black'),
axis.title = element_text(size=17, color='black'),
axis.line = element_blank(),
legend.text.align = 0,
legend.title =  element_text(size = 13, color = "black"),
legend.text = element_text(size = 11))
lm2_module = lm(ave ~ mean_dist_in_km ,data=pol) #in null pols
lm3_module = lm(ave ~ mean_dist_in_km ,data=pla) #in null plants
lm4_module = lm(ave ~ mean_dist_in_km ,data=both) #in null both
summary(lm1_module)
summary(lm2_module)
summary(lm3_module)
summary(lm4_module)
